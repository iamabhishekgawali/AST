{
  "type": "compilation_unit",
  "text": "using Microsoft.AspNetCore.Mvc;\r\nusing Microsoft.EntityFrameworkCore;\r\nusing Microsoft.IdentityModel.Tokens;\r\nusing System.IdentityModel.Tokens.Jwt;\r\nusing BCrypt.Net;\r\nusing System.Security.Claims;\r\nusing System.Text;\r\nusing First_Backend.Data;\r\nusing First_Backend.Models;\r\nusing First_Backend.Dtos;\r\n\r\nnamespace First_Backend.Controllers\r\n{\r\n    [ApiController] // Specified as an API controller\r\n    [Route(\"api/auth\")]\r\n    public class AuthController: ControllerBase\r\n    {\r\n        private readonly MyDbContext _context;\r\n        private readonly IConfiguration _configuration;\r\n\r\n        public AuthController(MyDbContext context, IConfiguration configuration)\r\n        {\r\n            _context = context;\r\n            _configuration = configuration;\r\n        }\r\n\r\n        // Login the user\r\n        [HttpPost(\"login\")]\r\n        public async Task<IActionResult> Login([FromBody] LoginRequest loginRequest)\r\n        {\r\n            // Find the user by email\r\n            var user = await _context.Users.FirstOrDefaultAsync(u => u.Email == loginRequest.Email);\r\n            if (user == null)\r\n            {\r\n                // Return Unauthorized for login error\r\n                return Unauthorized(\"Invalid email or password.\");\r\n            }\r\n\r\n            if (!BCrypt.Net.BCrypt.Verify(loginRequest.Password, user.Password))\r\n            {\r\n                // Return Unauthorized for wrong password\r\n                return Unauthorized(\"Invalid email or password\");\r\n            }\r\n\r\n            var token = GenerateJwtToken(user);\r\n            return Ok(new { token });\r\n        }\r\n\r\n        // Generate JWT Token\r\n        public string GenerateJwtToken(User user)\r\n        {\r\n            // Configuring JWT Authentication\r\n            var jwtKey = _configuration[\"Jwt:Key\"]; // JWT Key\r\n            var jwtIssuer = _configuration[\"Jwt:Issuer\"]; // JWT Issuer\r\n            var jwtAudience = _configuration[\"Jwt:Audience\"]; // JWT Audience\r\n\r\n            // Check if the JWT config values are missing\r\n            if (string.IsNullOrEmpty(jwtKey) || string.IsNullOrEmpty(jwtIssuer) || string.IsNullOrEmpty(jwtAudience))\r\n            {\r\n                throw new InvalidOperationException(\"JWT configuration values are missing\");\r\n            }\r\n\r\n            var securityKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtKey));\r\n            var credentials = new SigningCredentials(securityKey, SecurityAlgorithms.HmacSha256); // SHA 256\r\n\r\n            var claims = new[]\r\n            {\r\n                new Claim(JwtRegisteredClaimNames.Sub, user.Email),\r\n                new Claim(JwtRegisteredClaimNames.Jti, Guid.NewGuid().ToString())\r\n            };\r\n\r\n            var token = new JwtSecurityToken(\r\n                issuer: jwtIssuer,\r\n                audience: jwtAudience,\r\n                claims: claims,\r\n                expires: DateTime.Now.AddMinutes(30), // 30 mins expiry\r\n                signingCredentials: credentials);\r\n            \r\n            return new JwtSecurityTokenHandler().WriteToken(token);\r\n        }\r\n    }\r\n}",
  "startPosition": {
    "row": 0,
    "column": 0
  },
  "endPosition": {
    "row": 81,
    "column": 1
  },
  "children": [
    {
      "type": "using_directive",
      "text": "using Microsoft.AspNetCore.Mvc;",
      "startPosition": {
        "row": 0,
        "column": 0
      },
      "endPosition": {
        "row": 0,
        "column": 31
      },
      "children": [
        {
          "type": "qualified_name",
          "text": "Microsoft.AspNetCore.Mvc",
          "startPosition": {
            "row": 0,
            "column": 6
          },
          "endPosition": {
            "row": 0,
            "column": 30
          },
          "children": [
            {
              "type": "qualified_name",
              "text": "Microsoft.AspNetCore",
              "startPosition": {
                "row": 0,
                "column": 6
              },
              "endPosition": {
                "row": 0,
                "column": 26
              },
              "children": [
                {
                  "type": "identifier",
                  "text": "Microsoft",
                  "startPosition": {
                    "row": 0,
                    "column": 6
                  },
                  "endPosition": {
                    "row": 0,
                    "column": 15
                  },
                  "children": []
                },
                {
                  "type": "identifier",
                  "text": "AspNetCore",
                  "startPosition": {
                    "row": 0,
                    "column": 16
                  },
                  "endPosition": {
                    "row": 0,
                    "column": 26
                  },
                  "children": []
                }
              ]
            },
            {
              "type": "identifier",
              "text": "Mvc",
              "startPosition": {
                "row": 0,
                "column": 27
              },
              "endPosition": {
                "row": 0,
                "column": 30
              },
              "children": []
            }
          ]
        }
      ]
    },
    {
      "type": "using_directive",
      "text": "using Microsoft.EntityFrameworkCore;",
      "startPosition": {
        "row": 1,
        "column": 0
      },
      "endPosition": {
        "row": 1,
        "column": 36
      },
      "children": [
        {
          "type": "qualified_name",
          "text": "Microsoft.EntityFrameworkCore",
          "startPosition": {
            "row": 1,
            "column": 6
          },
          "endPosition": {
            "row": 1,
            "column": 35
          },
          "children": [
            {
              "type": "identifier",
              "text": "Microsoft",
              "startPosition": {
                "row": 1,
                "column": 6
              },
              "endPosition": {
                "row": 1,
                "column": 15
              },
              "children": []
            },
            {
              "type": "identifier",
              "text": "EntityFrameworkCore",
              "startPosition": {
                "row": 1,
                "column": 16
              },
              "endPosition": {
                "row": 1,
                "column": 35
              },
              "children": []
            }
          ]
        }
      ]
    },
    {
      "type": "using_directive",
      "text": "using Microsoft.IdentityModel.Tokens;",
      "startPosition": {
        "row": 2,
        "column": 0
      },
      "endPosition": {
        "row": 2,
        "column": 37
      },
      "children": [
        {
          "type": "qualified_name",
          "text": "Microsoft.IdentityModel.Tokens",
          "startPosition": {
            "row": 2,
            "column": 6
          },
          "endPosition": {
            "row": 2,
            "column": 36
          },
          "children": [
            {
              "type": "qualified_name",
              "text": "Microsoft.IdentityModel",
              "startPosition": {
                "row": 2,
                "column": 6
              },
              "endPosition": {
                "row": 2,
                "column": 29
              },
              "children": [
                {
                  "type": "identifier",
                  "text": "Microsoft",
                  "startPosition": {
                    "row": 2,
                    "column": 6
                  },
                  "endPosition": {
                    "row": 2,
                    "column": 15
                  },
                  "children": []
                },
                {
                  "type": "identifier",
                  "text": "IdentityModel",
                  "startPosition": {
                    "row": 2,
                    "column": 16
                  },
                  "endPosition": {
                    "row": 2,
                    "column": 29
                  },
                  "children": []
                }
              ]
            },
            {
              "type": "identifier",
              "text": "Tokens",
              "startPosition": {
                "row": 2,
                "column": 30
              },
              "endPosition": {
                "row": 2,
                "column": 36
              },
              "children": []
            }
          ]
        }
      ]
    },
    {
      "type": "using_directive",
      "text": "using System.IdentityModel.Tokens.Jwt;",
      "startPosition": {
        "row": 3,
        "column": 0
      },
      "endPosition": {
        "row": 3,
        "column": 38
      },
      "children": [
        {
          "type": "qualified_name",
          "text": "System.IdentityModel.Tokens.Jwt",
          "startPosition": {
            "row": 3,
            "column": 6
          },
          "endPosition": {
            "row": 3,
            "column": 37
          },
          "children": [
            {
              "type": "qualified_name",
              "text": "System.IdentityModel.Tokens",
              "startPosition": {
                "row": 3,
                "column": 6
              },
              "endPosition": {
                "row": 3,
                "column": 33
              },
              "children": [
                {
                  "type": "qualified_name",
                  "text": "System.IdentityModel",
                  "startPosition": {
                    "row": 3,
                    "column": 6
                  },
                  "endPosition": {
                    "row": 3,
                    "column": 26
                  },
                  "children": [
                    {
                      "type": "identifier",
                      "text": "System",
                      "startPosition": {
                        "row": 3,
                        "column": 6
                      },
                      "endPosition": {
                        "row": 3,
                        "column": 12
                      },
                      "children": []
                    },
                    {
                      "type": "identifier",
                      "text": "IdentityModel",
                      "startPosition": {
                        "row": 3,
                        "column": 13
                      },
                      "endPosition": {
                        "row": 3,
                        "column": 26
                      },
                      "children": []
                    }
                  ]
                },
                {
                  "type": "identifier",
                  "text": "Tokens",
                  "startPosition": {
                    "row": 3,
                    "column": 27
                  },
                  "endPosition": {
                    "row": 3,
                    "column": 33
                  },
                  "children": []
                }
              ]
            },
            {
              "type": "identifier",
              "text": "Jwt",
              "startPosition": {
                "row": 3,
                "column": 34
              },
              "endPosition": {
                "row": 3,
                "column": 37
              },
              "children": []
            }
          ]
        }
      ]
    },
    {
      "type": "using_directive",
      "text": "using BCrypt.Net;",
      "startPosition": {
        "row": 4,
        "column": 0
      },
      "endPosition": {
        "row": 4,
        "column": 17
      },
      "children": [
        {
          "type": "qualified_name",
          "text": "BCrypt.Net",
          "startPosition": {
            "row": 4,
            "column": 6
          },
          "endPosition": {
            "row": 4,
            "column": 16
          },
          "children": [
            {
              "type": "identifier",
              "text": "BCrypt",
              "startPosition": {
                "row": 4,
                "column": 6
              },
              "endPosition": {
                "row": 4,
                "column": 12
              },
              "children": []
            },
            {
              "type": "identifier",
              "text": "Net",
              "startPosition": {
                "row": 4,
                "column": 13
              },
              "endPosition": {
                "row": 4,
                "column": 16
              },
              "children": []
            }
          ]
        }
      ]
    },
    {
      "type": "using_directive",
      "text": "using System.Security.Claims;",
      "startPosition": {
        "row": 5,
        "column": 0
      },
      "endPosition": {
        "row": 5,
        "column": 29
      },
      "children": [
        {
          "type": "qualified_name",
          "text": "System.Security.Claims",
          "startPosition": {
            "row": 5,
            "column": 6
          },
          "endPosition": {
            "row": 5,
            "column": 28
          },
          "children": [
            {
              "type": "qualified_name",
              "text": "System.Security",
              "startPosition": {
                "row": 5,
                "column": 6
              },
              "endPosition": {
                "row": 5,
                "column": 21
              },
              "children": [
                {
                  "type": "identifier",
                  "text": "System",
                  "startPosition": {
                    "row": 5,
                    "column": 6
                  },
                  "endPosition": {
                    "row": 5,
                    "column": 12
                  },
                  "children": []
                },
                {
                  "type": "identifier",
                  "text": "Security",
                  "startPosition": {
                    "row": 5,
                    "column": 13
                  },
                  "endPosition": {
                    "row": 5,
                    "column": 21
                  },
                  "children": []
                }
              ]
            },
            {
              "type": "identifier",
              "text": "Claims",
              "startPosition": {
                "row": 5,
                "column": 22
              },
              "endPosition": {
                "row": 5,
                "column": 28
              },
              "children": []
            }
          ]
        }
      ]
    },
    {
      "type": "using_directive",
      "text": "using System.Text;",
      "startPosition": {
        "row": 6,
        "column": 0
      },
      "endPosition": {
        "row": 6,
        "column": 18
      },
      "children": [
        {
          "type": "qualified_name",
          "text": "System.Text",
          "startPosition": {
            "row": 6,
            "column": 6
          },
          "endPosition": {
            "row": 6,
            "column": 17
          },
          "children": [
            {
              "type": "identifier",
              "text": "System",
              "startPosition": {
                "row": 6,
                "column": 6
              },
              "endPosition": {
                "row": 6,
                "column": 12
              },
              "children": []
            },
            {
              "type": "identifier",
              "text": "Text",
              "startPosition": {
                "row": 6,
                "column": 13
              },
              "endPosition": {
                "row": 6,
                "column": 17
              },
              "children": []
            }
          ]
        }
      ]
    },
    {
      "type": "using_directive",
      "text": "using First_Backend.Data;",
      "startPosition": {
        "row": 7,
        "column": 0
      },
      "endPosition": {
        "row": 7,
        "column": 25
      },
      "children": [
        {
          "type": "qualified_name",
          "text": "First_Backend.Data",
          "startPosition": {
            "row": 7,
            "column": 6
          },
          "endPosition": {
            "row": 7,
            "column": 24
          },
          "children": [
            {
              "type": "identifier",
              "text": "First_Backend",
              "startPosition": {
                "row": 7,
                "column": 6
              },
              "endPosition": {
                "row": 7,
                "column": 19
              },
              "children": []
            },
            {
              "type": "identifier",
              "text": "Data",
              "startPosition": {
                "row": 7,
                "column": 20
              },
              "endPosition": {
                "row": 7,
                "column": 24
              },
              "children": []
            }
          ]
        }
      ]
    },
    {
      "type": "using_directive",
      "text": "using First_Backend.Models;",
      "startPosition": {
        "row": 8,
        "column": 0
      },
      "endPosition": {
        "row": 8,
        "column": 27
      },
      "children": [
        {
          "type": "qualified_name",
          "text": "First_Backend.Models",
          "startPosition": {
            "row": 8,
            "column": 6
          },
          "endPosition": {
            "row": 8,
            "column": 26
          },
          "children": [
            {
              "type": "identifier",
              "text": "First_Backend",
              "startPosition": {
                "row": 8,
                "column": 6
              },
              "endPosition": {
                "row": 8,
                "column": 19
              },
              "children": []
            },
            {
              "type": "identifier",
              "text": "Models",
              "startPosition": {
                "row": 8,
                "column": 20
              },
              "endPosition": {
                "row": 8,
                "column": 26
              },
              "children": []
            }
          ]
        }
      ]
    },
    {
      "type": "using_directive",
      "text": "using First_Backend.Dtos;",
      "startPosition": {
        "row": 9,
        "column": 0
      },
      "endPosition": {
        "row": 9,
        "column": 25
      },
      "children": [
        {
          "type": "qualified_name",
          "text": "First_Backend.Dtos",
          "startPosition": {
            "row": 9,
            "column": 6
          },
          "endPosition": {
            "row": 9,
            "column": 24
          },
          "children": [
            {
              "type": "identifier",
              "text": "First_Backend",
              "startPosition": {
                "row": 9,
                "column": 6
              },
              "endPosition": {
                "row": 9,
                "column": 19
              },
              "children": []
            },
            {
              "type": "identifier",
              "text": "Dtos",
              "startPosition": {
                "row": 9,
                "column": 20
              },
              "endPosition": {
                "row": 9,
                "column": 24
              },
              "children": []
            }
          ]
        }
      ]
    },
    {
      "type": "namespace_declaration",
      "text": "namespace First_Backend.Controllers\r\n{\r\n    [ApiController] // Specified as an API controller\r\n    [Route(\"api/auth\")]\r\n    public class AuthController: ControllerBase\r\n    {\r\n        private readonly MyDbContext _context;\r\n        private readonly IConfiguration _configuration;\r\n\r\n        public AuthController(MyDbContext context, IConfiguration configuration)\r\n        {\r\n            _context = context;\r\n            _configuration = configuration;\r\n        }\r\n\r\n        // Login the user\r\n        [HttpPost(\"login\")]\r\n        public async Task<IActionResult> Login([FromBody] LoginRequest loginRequest)\r\n        {\r\n            // Find the user by email\r\n            var user = await _context.Users.FirstOrDefaultAsync(u => u.Email == loginRequest.Email);\r\n            if (user == null)\r\n            {\r\n                // Return Unauthorized for login error\r\n                return Unauthorized(\"Invalid email or password.\");\r\n            }\r\n\r\n            if (!BCrypt.Net.BCrypt.Verify(loginRequest.Password, user.Password))\r\n            {\r\n                // Return Unauthorized for wrong password\r\n                return Unauthorized(\"Invalid email or password\");\r\n            }\r\n\r\n            var token = GenerateJwtToken(user);\r\n            return Ok(new { token });\r\n        }\r\n\r\n        // Generate JWT Token\r\n        public string GenerateJwtToken(User user)\r\n        {\r\n            // Configuring JWT Authentication\r\n            var jwtKey = _configuration[\"Jwt:Key\"]; // JWT Key\r\n            var jwtIssuer = _configuration[\"Jwt:Issuer\"]; // JWT Issuer\r\n            var jwtAudience = _configuration[\"Jwt:Audience\"]; // JWT Audience\r\n\r\n            // Check if the JWT config values are missing\r\n            if (string.IsNullOrEmpty(jwtKey) || string.IsNullOrEmpty(jwtIssuer) || string.IsNullOrEmpty(jwtAudience))\r\n            {\r\n                throw new InvalidOperationException(\"JWT configuration values are missing\");\r\n            }\r\n\r\n            var securityKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtKey));\r\n            var credentials = new SigningCredentials(securityKey, SecurityAlgorithms.HmacSha256); // SHA 256\r\n\r\n            var claims = new[]\r\n            {\r\n                new Claim(JwtRegisteredClaimNames.Sub, user.Email),\r\n                new Claim(JwtRegisteredClaimNames.Jti, Guid.NewGuid().ToString())\r\n            };\r\n\r\n            var token = new JwtSecurityToken(\r\n                issuer: jwtIssuer,\r\n                audience: jwtAudience,\r\n                claims: claims,\r\n                expires: DateTime.Now.AddMinutes(30), // 30 mins expiry\r\n                signingCredentials: credentials);\r\n            \r\n            return new JwtSecurityTokenHandler().WriteToken(token);\r\n        }\r\n    }\r\n}",
      "startPosition": {
        "row": 11,
        "column": 0
      },
      "endPosition": {
        "row": 81,
        "column": 1
      },
      "children": [
        {
          "type": "qualified_name",
          "text": "First_Backend.Controllers",
          "startPosition": {
            "row": 11,
            "column": 10
          },
          "endPosition": {
            "row": 11,
            "column": 35
          },
          "children": [
            {
              "type": "identifier",
              "text": "First_Backend",
              "startPosition": {
                "row": 11,
                "column": 10
              },
              "endPosition": {
                "row": 11,
                "column": 23
              },
              "children": []
            },
            {
              "type": "identifier",
              "text": "Controllers",
              "startPosition": {
                "row": 11,
                "column": 24
              },
              "endPosition": {
                "row": 11,
                "column": 35
              },
              "children": []
            }
          ]
        },
        {
          "type": "declaration_list",
          "text": "{\r\n    [ApiController] // Specified as an API controller\r\n    [Route(\"api/auth\")]\r\n    public class AuthController: ControllerBase\r\n    {\r\n        private readonly MyDbContext _context;\r\n        private readonly IConfiguration _configuration;\r\n\r\n        public AuthController(MyDbContext context, IConfiguration configuration)\r\n        {\r\n            _context = context;\r\n            _configuration = configuration;\r\n        }\r\n\r\n        // Login the user\r\n        [HttpPost(\"login\")]\r\n        public async Task<IActionResult> Login([FromBody] LoginRequest loginRequest)\r\n        {\r\n            // Find the user by email\r\n            var user = await _context.Users.FirstOrDefaultAsync(u => u.Email == loginRequest.Email);\r\n            if (user == null)\r\n            {\r\n                // Return Unauthorized for login error\r\n                return Unauthorized(\"Invalid email or password.\");\r\n            }\r\n\r\n            if (!BCrypt.Net.BCrypt.Verify(loginRequest.Password, user.Password))\r\n            {\r\n                // Return Unauthorized for wrong password\r\n                return Unauthorized(\"Invalid email or password\");\r\n            }\r\n\r\n            var token = GenerateJwtToken(user);\r\n            return Ok(new { token });\r\n        }\r\n\r\n        // Generate JWT Token\r\n        public string GenerateJwtToken(User user)\r\n        {\r\n            // Configuring JWT Authentication\r\n            var jwtKey = _configuration[\"Jwt:Key\"]; // JWT Key\r\n            var jwtIssuer = _configuration[\"Jwt:Issuer\"]; // JWT Issuer\r\n            var jwtAudience = _configuration[\"Jwt:Audience\"]; // JWT Audience\r\n\r\n            // Check if the JWT config values are missing\r\n            if (string.IsNullOrEmpty(jwtKey) || string.IsNullOrEmpty(jwtIssuer) || string.IsNullOrEmpty(jwtAudience))\r\n            {\r\n                throw new InvalidOperationException(\"JWT configuration values are missing\");\r\n            }\r\n\r\n            var securityKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtKey));\r\n            var credentials = new SigningCredentials(securityKey, SecurityAlgorithms.HmacSha256); // SHA 256\r\n\r\n            var claims = new[]\r\n            {\r\n                new Claim(JwtRegisteredClaimNames.Sub, user.Email),\r\n                new Claim(JwtRegisteredClaimNames.Jti, Guid.NewGuid().ToString())\r\n            };\r\n\r\n            var token = new JwtSecurityToken(\r\n                issuer: jwtIssuer,\r\n                audience: jwtAudience,\r\n                claims: claims,\r\n                expires: DateTime.Now.AddMinutes(30), // 30 mins expiry\r\n                signingCredentials: credentials);\r\n            \r\n            return new JwtSecurityTokenHandler().WriteToken(token);\r\n        }\r\n    }\r\n}",
          "startPosition": {
            "row": 12,
            "column": 0
          },
          "endPosition": {
            "row": 81,
            "column": 1
          },
          "children": [
            {
              "type": "class_declaration",
              "text": "[ApiController] // Specified as an API controller\r\n    [Route(\"api/auth\")]\r\n    public class AuthController: ControllerBase\r\n    {\r\n        private readonly MyDbContext _context;\r\n        private readonly IConfiguration _configuration;\r\n\r\n        public AuthController(MyDbContext context, IConfiguration configuration)\r\n        {\r\n            _context = context;\r\n            _configuration = configuration;\r\n        }\r\n\r\n        // Login the user\r\n        [HttpPost(\"login\")]\r\n        public async Task<IActionResult> Login([FromBody] LoginRequest loginRequest)\r\n        {\r\n            // Find the user by email\r\n            var user = await _context.Users.FirstOrDefaultAsync(u => u.Email == loginRequest.Email);\r\n            if (user == null)\r\n            {\r\n                // Return Unauthorized for login error\r\n                return Unauthorized(\"Invalid email or password.\");\r\n            }\r\n\r\n            if (!BCrypt.Net.BCrypt.Verify(loginRequest.Password, user.Password))\r\n            {\r\n                // Return Unauthorized for wrong password\r\n                return Unauthorized(\"Invalid email or password\");\r\n            }\r\n\r\n            var token = GenerateJwtToken(user);\r\n            return Ok(new { token });\r\n        }\r\n\r\n        // Generate JWT Token\r\n        public string GenerateJwtToken(User user)\r\n        {\r\n            // Configuring JWT Authentication\r\n            var jwtKey = _configuration[\"Jwt:Key\"]; // JWT Key\r\n            var jwtIssuer = _configuration[\"Jwt:Issuer\"]; // JWT Issuer\r\n            var jwtAudience = _configuration[\"Jwt:Audience\"]; // JWT Audience\r\n\r\n            // Check if the JWT config values are missing\r\n            if (string.IsNullOrEmpty(jwtKey) || string.IsNullOrEmpty(jwtIssuer) || string.IsNullOrEmpty(jwtAudience))\r\n            {\r\n                throw new InvalidOperationException(\"JWT configuration values are missing\");\r\n            }\r\n\r\n            var securityKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtKey));\r\n            var credentials = new SigningCredentials(securityKey, SecurityAlgorithms.HmacSha256); // SHA 256\r\n\r\n            var claims = new[]\r\n            {\r\n                new Claim(JwtRegisteredClaimNames.Sub, user.Email),\r\n                new Claim(JwtRegisteredClaimNames.Jti, Guid.NewGuid().ToString())\r\n            };\r\n\r\n            var token = new JwtSecurityToken(\r\n                issuer: jwtIssuer,\r\n                audience: jwtAudience,\r\n                claims: claims,\r\n                expires: DateTime.Now.AddMinutes(30), // 30 mins expiry\r\n                signingCredentials: credentials);\r\n            \r\n            return new JwtSecurityTokenHandler().WriteToken(token);\r\n        }\r\n    }",
              "startPosition": {
                "row": 13,
                "column": 4
              },
              "endPosition": {
                "row": 80,
                "column": 5
              },
              "children": [
                {
                  "type": "attribute_list",
                  "text": "[ApiController]",
                  "startPosition": {
                    "row": 13,
                    "column": 4
                  },
                  "endPosition": {
                    "row": 13,
                    "column": 19
                  },
                  "children": [
                    {
                      "type": "attribute",
                      "text": "ApiController",
                      "startPosition": {
                        "row": 13,
                        "column": 5
                      },
                      "endPosition": {
                        "row": 13,
                        "column": 18
                      },
                      "children": [
                        {
                          "type": "identifier",
                          "text": "ApiController",
                          "startPosition": {
                            "row": 13,
                            "column": 5
                          },
                          "endPosition": {
                            "row": 13,
                            "column": 18
                          },
                          "children": []
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "comment",
                  "text": "// Specified as an API controller",
                  "startPosition": {
                    "row": 13,
                    "column": 20
                  },
                  "endPosition": {
                    "row": 13,
                    "column": 53
                  },
                  "children": []
                },
                {
                  "type": "attribute_list",
                  "text": "[Route(\"api/auth\")]",
                  "startPosition": {
                    "row": 14,
                    "column": 4
                  },
                  "endPosition": {
                    "row": 14,
                    "column": 23
                  },
                  "children": [
                    {
                      "type": "attribute",
                      "text": "Route(\"api/auth\")",
                      "startPosition": {
                        "row": 14,
                        "column": 5
                      },
                      "endPosition": {
                        "row": 14,
                        "column": 22
                      },
                      "children": [
                        {
                          "type": "identifier",
                          "text": "Route",
                          "startPosition": {
                            "row": 14,
                            "column": 5
                          },
                          "endPosition": {
                            "row": 14,
                            "column": 10
                          },
                          "children": []
                        },
                        {
                          "type": "attribute_argument_list",
                          "text": "(\"api/auth\")",
                          "startPosition": {
                            "row": 14,
                            "column": 10
                          },
                          "endPosition": {
                            "row": 14,
                            "column": 22
                          },
                          "children": [
                            {
                              "type": "attribute_argument",
                              "text": "\"api/auth\"",
                              "startPosition": {
                                "row": 14,
                                "column": 11
                              },
                              "endPosition": {
                                "row": 14,
                                "column": 21
                              },
                              "children": [
                                {
                                  "type": "string_literal",
                                  "text": "\"api/auth\"",
                                  "startPosition": {
                                    "row": 14,
                                    "column": 11
                                  },
                                  "endPosition": {
                                    "row": 14,
                                    "column": 21
                                  },
                                  "children": [
                                    {
                                      "type": "string_literal_fragment",
                                      "text": "api/auth",
                                      "startPosition": {
                                        "row": 14,
                                        "column": 12
                                      },
                                      "endPosition": {
                                        "row": 14,
                                        "column": 20
                                      },
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "modifier",
                  "text": "public",
                  "startPosition": {
                    "row": 15,
                    "column": 4
                  },
                  "endPosition": {
                    "row": 15,
                    "column": 10
                  },
                  "children": []
                },
                {
                  "type": "identifier",
                  "text": "AuthController",
                  "startPosition": {
                    "row": 15,
                    "column": 17
                  },
                  "endPosition": {
                    "row": 15,
                    "column": 31
                  },
                  "children": []
                },
                {
                  "type": "base_list",
                  "text": ": ControllerBase",
                  "startPosition": {
                    "row": 15,
                    "column": 31
                  },
                  "endPosition": {
                    "row": 15,
                    "column": 47
                  },
                  "children": [
                    {
                      "type": "identifier",
                      "text": "ControllerBase",
                      "startPosition": {
                        "row": 15,
                        "column": 33
                      },
                      "endPosition": {
                        "row": 15,
                        "column": 47
                      },
                      "children": []
                    }
                  ]
                },
                {
                  "type": "declaration_list",
                  "text": "{\r\n        private readonly MyDbContext _context;\r\n        private readonly IConfiguration _configuration;\r\n\r\n        public AuthController(MyDbContext context, IConfiguration configuration)\r\n        {\r\n            _context = context;\r\n            _configuration = configuration;\r\n        }\r\n\r\n        // Login the user\r\n        [HttpPost(\"login\")]\r\n        public async Task<IActionResult> Login([FromBody] LoginRequest loginRequest)\r\n        {\r\n            // Find the user by email\r\n            var user = await _context.Users.FirstOrDefaultAsync(u => u.Email == loginRequest.Email);\r\n            if (user == null)\r\n            {\r\n                // Return Unauthorized for login error\r\n                return Unauthorized(\"Invalid email or password.\");\r\n            }\r\n\r\n            if (!BCrypt.Net.BCrypt.Verify(loginRequest.Password, user.Password))\r\n            {\r\n                // Return Unauthorized for wrong password\r\n                return Unauthorized(\"Invalid email or password\");\r\n            }\r\n\r\n            var token = GenerateJwtToken(user);\r\n            return Ok(new { token });\r\n        }\r\n\r\n        // Generate JWT Token\r\n        public string GenerateJwtToken(User user)\r\n        {\r\n            // Configuring JWT Authentication\r\n            var jwtKey = _configuration[\"Jwt:Key\"]; // JWT Key\r\n            var jwtIssuer = _configuration[\"Jwt:Issuer\"]; // JWT Issuer\r\n            var jwtAudience = _configuration[\"Jwt:Audience\"]; // JWT Audience\r\n\r\n            // Check if the JWT config values are missing\r\n            if (string.IsNullOrEmpty(jwtKey) || string.IsNullOrEmpty(jwtIssuer) || string.IsNullOrEmpty(jwtAudience))\r\n            {\r\n                throw new InvalidOperationException(\"JWT configuration values are missing\");\r\n            }\r\n\r\n            var securityKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtKey));\r\n            var credentials = new SigningCredentials(securityKey, SecurityAlgorithms.HmacSha256); // SHA 256\r\n\r\n            var claims = new[]\r\n            {\r\n                new Claim(JwtRegisteredClaimNames.Sub, user.Email),\r\n                new Claim(JwtRegisteredClaimNames.Jti, Guid.NewGuid().ToString())\r\n            };\r\n\r\n            var token = new JwtSecurityToken(\r\n                issuer: jwtIssuer,\r\n                audience: jwtAudience,\r\n                claims: claims,\r\n                expires: DateTime.Now.AddMinutes(30), // 30 mins expiry\r\n                signingCredentials: credentials);\r\n            \r\n            return new JwtSecurityTokenHandler().WriteToken(token);\r\n        }\r\n    }",
                  "startPosition": {
                    "row": 16,
                    "column": 4
                  },
                  "endPosition": {
                    "row": 80,
                    "column": 5
                  },
                  "children": [
                    {
                      "type": "field_declaration",
                      "text": "private readonly MyDbContext _context;",
                      "startPosition": {
                        "row": 17,
                        "column": 8
                      },
                      "endPosition": {
                        "row": 17,
                        "column": 46
                      },
                      "children": [
                        {
                          "type": "modifier",
                          "text": "private",
                          "startPosition": {
                            "row": 17,
                            "column": 8
                          },
                          "endPosition": {
                            "row": 17,
                            "column": 15
                          },
                          "children": []
                        },
                        {
                          "type": "modifier",
                          "text": "readonly",
                          "startPosition": {
                            "row": 17,
                            "column": 16
                          },
                          "endPosition": {
                            "row": 17,
                            "column": 24
                          },
                          "children": []
                        },
                        {
                          "type": "variable_declaration",
                          "text": "MyDbContext _context",
                          "startPosition": {
                            "row": 17,
                            "column": 25
                          },
                          "endPosition": {
                            "row": 17,
                            "column": 45
                          },
                          "children": [
                            {
                              "type": "identifier",
                              "text": "MyDbContext",
                              "startPosition": {
                                "row": 17,
                                "column": 25
                              },
                              "endPosition": {
                                "row": 17,
                                "column": 36
                              },
                              "children": []
                            },
                            {
                              "type": "variable_declarator",
                              "text": "_context",
                              "startPosition": {
                                "row": 17,
                                "column": 37
                              },
                              "endPosition": {
                                "row": 17,
                                "column": 45
                              },
                              "children": [
                                {
                                  "type": "identifier",
                                  "text": "_context",
                                  "startPosition": {
                                    "row": 17,
                                    "column": 37
                                  },
                                  "endPosition": {
                                    "row": 17,
                                    "column": 45
                                  },
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "field_declaration",
                      "text": "private readonly IConfiguration _configuration;",
                      "startPosition": {
                        "row": 18,
                        "column": 8
                      },
                      "endPosition": {
                        "row": 18,
                        "column": 55
                      },
                      "children": [
                        {
                          "type": "modifier",
                          "text": "private",
                          "startPosition": {
                            "row": 18,
                            "column": 8
                          },
                          "endPosition": {
                            "row": 18,
                            "column": 15
                          },
                          "children": []
                        },
                        {
                          "type": "modifier",
                          "text": "readonly",
                          "startPosition": {
                            "row": 18,
                            "column": 16
                          },
                          "endPosition": {
                            "row": 18,
                            "column": 24
                          },
                          "children": []
                        },
                        {
                          "type": "variable_declaration",
                          "text": "IConfiguration _configuration",
                          "startPosition": {
                            "row": 18,
                            "column": 25
                          },
                          "endPosition": {
                            "row": 18,
                            "column": 54
                          },
                          "children": [
                            {
                              "type": "identifier",
                              "text": "IConfiguration",
                              "startPosition": {
                                "row": 18,
                                "column": 25
                              },
                              "endPosition": {
                                "row": 18,
                                "column": 39
                              },
                              "children": []
                            },
                            {
                              "type": "variable_declarator",
                              "text": "_configuration",
                              "startPosition": {
                                "row": 18,
                                "column": 40
                              },
                              "endPosition": {
                                "row": 18,
                                "column": 54
                              },
                              "children": [
                                {
                                  "type": "identifier",
                                  "text": "_configuration",
                                  "startPosition": {
                                    "row": 18,
                                    "column": 40
                                  },
                                  "endPosition": {
                                    "row": 18,
                                    "column": 54
                                  },
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "constructor_declaration",
                      "text": "public AuthController(MyDbContext context, IConfiguration configuration)\r\n        {\r\n            _context = context;\r\n            _configuration = configuration;\r\n        }",
                      "startPosition": {
                        "row": 20,
                        "column": 8
                      },
                      "endPosition": {
                        "row": 24,
                        "column": 9
                      },
                      "children": [
                        {
                          "type": "modifier",
                          "text": "public",
                          "startPosition": {
                            "row": 20,
                            "column": 8
                          },
                          "endPosition": {
                            "row": 20,
                            "column": 14
                          },
                          "children": []
                        },
                        {
                          "type": "identifier",
                          "text": "AuthController",
                          "startPosition": {
                            "row": 20,
                            "column": 15
                          },
                          "endPosition": {
                            "row": 20,
                            "column": 29
                          },
                          "children": []
                        },
                        {
                          "type": "parameter_list",
                          "text": "(MyDbContext context, IConfiguration configuration)",
                          "startPosition": {
                            "row": 20,
                            "column": 29
                          },
                          "endPosition": {
                            "row": 20,
                            "column": 80
                          },
                          "children": [
                            {
                              "type": "parameter",
                              "text": "MyDbContext context",
                              "startPosition": {
                                "row": 20,
                                "column": 30
                              },
                              "endPosition": {
                                "row": 20,
                                "column": 49
                              },
                              "children": [
                                {
                                  "type": "identifier",
                                  "text": "MyDbContext",
                                  "startPosition": {
                                    "row": 20,
                                    "column": 30
                                  },
                                  "endPosition": {
                                    "row": 20,
                                    "column": 41
                                  },
                                  "children": []
                                },
                                {
                                  "type": "identifier",
                                  "text": "context",
                                  "startPosition": {
                                    "row": 20,
                                    "column": 42
                                  },
                                  "endPosition": {
                                    "row": 20,
                                    "column": 49
                                  },
                                  "children": []
                                }
                              ]
                            },
                            {
                              "type": "parameter",
                              "text": "IConfiguration configuration",
                              "startPosition": {
                                "row": 20,
                                "column": 51
                              },
                              "endPosition": {
                                "row": 20,
                                "column": 79
                              },
                              "children": [
                                {
                                  "type": "identifier",
                                  "text": "IConfiguration",
                                  "startPosition": {
                                    "row": 20,
                                    "column": 51
                                  },
                                  "endPosition": {
                                    "row": 20,
                                    "column": 65
                                  },
                                  "children": []
                                },
                                {
                                  "type": "identifier",
                                  "text": "configuration",
                                  "startPosition": {
                                    "row": 20,
                                    "column": 66
                                  },
                                  "endPosition": {
                                    "row": 20,
                                    "column": 79
                                  },
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "block",
                          "text": "{\r\n            _context = context;\r\n            _configuration = configuration;\r\n        }",
                          "startPosition": {
                            "row": 21,
                            "column": 8
                          },
                          "endPosition": {
                            "row": 24,
                            "column": 9
                          },
                          "children": [
                            {
                              "type": "expression_statement",
                              "text": "_context = context;",
                              "startPosition": {
                                "row": 22,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 22,
                                "column": 31
                              },
                              "children": [
                                {
                                  "type": "assignment_expression",
                                  "text": "_context = context",
                                  "startPosition": {
                                    "row": 22,
                                    "column": 12
                                  },
                                  "endPosition": {
                                    "row": 22,
                                    "column": 30
                                  },
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "text": "_context",
                                      "startPosition": {
                                        "row": 22,
                                        "column": 12
                                      },
                                      "endPosition": {
                                        "row": 22,
                                        "column": 20
                                      },
                                      "children": []
                                    },
                                    {
                                      "type": "assignment_operator",
                                      "text": "=",
                                      "startPosition": {
                                        "row": 22,
                                        "column": 21
                                      },
                                      "endPosition": {
                                        "row": 22,
                                        "column": 22
                                      },
                                      "children": []
                                    },
                                    {
                                      "type": "identifier",
                                      "text": "context",
                                      "startPosition": {
                                        "row": 22,
                                        "column": 23
                                      },
                                      "endPosition": {
                                        "row": 22,
                                        "column": 30
                                      },
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "expression_statement",
                              "text": "_configuration = configuration;",
                              "startPosition": {
                                "row": 23,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 23,
                                "column": 43
                              },
                              "children": [
                                {
                                  "type": "assignment_expression",
                                  "text": "_configuration = configuration",
                                  "startPosition": {
                                    "row": 23,
                                    "column": 12
                                  },
                                  "endPosition": {
                                    "row": 23,
                                    "column": 42
                                  },
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "text": "_configuration",
                                      "startPosition": {
                                        "row": 23,
                                        "column": 12
                                      },
                                      "endPosition": {
                                        "row": 23,
                                        "column": 26
                                      },
                                      "children": []
                                    },
                                    {
                                      "type": "assignment_operator",
                                      "text": "=",
                                      "startPosition": {
                                        "row": 23,
                                        "column": 27
                                      },
                                      "endPosition": {
                                        "row": 23,
                                        "column": 28
                                      },
                                      "children": []
                                    },
                                    {
                                      "type": "identifier",
                                      "text": "configuration",
                                      "startPosition": {
                                        "row": 23,
                                        "column": 29
                                      },
                                      "endPosition": {
                                        "row": 23,
                                        "column": 42
                                      },
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "comment",
                      "text": "// Login the user",
                      "startPosition": {
                        "row": 26,
                        "column": 8
                      },
                      "endPosition": {
                        "row": 26,
                        "column": 25
                      },
                      "children": []
                    },
                    {
                      "type": "method_declaration",
                      "text": "[HttpPost(\"login\")]\r\n        public async Task<IActionResult> Login([FromBody] LoginRequest loginRequest)\r\n        {\r\n            // Find the user by email\r\n            var user = await _context.Users.FirstOrDefaultAsync(u => u.Email == loginRequest.Email);\r\n            if (user == null)\r\n            {\r\n                // Return Unauthorized for login error\r\n                return Unauthorized(\"Invalid email or password.\");\r\n            }\r\n\r\n            if (!BCrypt.Net.BCrypt.Verify(loginRequest.Password, user.Password))\r\n            {\r\n                // Return Unauthorized for wrong password\r\n                return Unauthorized(\"Invalid email or password\");\r\n            }\r\n\r\n            var token = GenerateJwtToken(user);\r\n            return Ok(new { token });\r\n        }",
                      "startPosition": {
                        "row": 27,
                        "column": 8
                      },
                      "endPosition": {
                        "row": 46,
                        "column": 9
                      },
                      "children": [
                        {
                          "type": "attribute_list",
                          "text": "[HttpPost(\"login\")]",
                          "startPosition": {
                            "row": 27,
                            "column": 8
                          },
                          "endPosition": {
                            "row": 27,
                            "column": 27
                          },
                          "children": [
                            {
                              "type": "attribute",
                              "text": "HttpPost(\"login\")",
                              "startPosition": {
                                "row": 27,
                                "column": 9
                              },
                              "endPosition": {
                                "row": 27,
                                "column": 26
                              },
                              "children": [
                                {
                                  "type": "identifier",
                                  "text": "HttpPost",
                                  "startPosition": {
                                    "row": 27,
                                    "column": 9
                                  },
                                  "endPosition": {
                                    "row": 27,
                                    "column": 17
                                  },
                                  "children": []
                                },
                                {
                                  "type": "attribute_argument_list",
                                  "text": "(\"login\")",
                                  "startPosition": {
                                    "row": 27,
                                    "column": 17
                                  },
                                  "endPosition": {
                                    "row": 27,
                                    "column": 26
                                  },
                                  "children": [
                                    {
                                      "type": "attribute_argument",
                                      "text": "\"login\"",
                                      "startPosition": {
                                        "row": 27,
                                        "column": 18
                                      },
                                      "endPosition": {
                                        "row": 27,
                                        "column": 25
                                      },
                                      "children": [
                                        {
                                          "type": "string_literal",
                                          "text": "\"login\"",
                                          "startPosition": {
                                            "row": 27,
                                            "column": 18
                                          },
                                          "endPosition": {
                                            "row": 27,
                                            "column": 25
                                          },
                                          "children": [
                                            {
                                              "type": "string_literal_fragment",
                                              "text": "login",
                                              "startPosition": {
                                                "row": 27,
                                                "column": 19
                                              },
                                              "endPosition": {
                                                "row": 27,
                                                "column": 24
                                              },
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "modifier",
                          "text": "public",
                          "startPosition": {
                            "row": 28,
                            "column": 8
                          },
                          "endPosition": {
                            "row": 28,
                            "column": 14
                          },
                          "children": []
                        },
                        {
                          "type": "modifier",
                          "text": "async",
                          "startPosition": {
                            "row": 28,
                            "column": 15
                          },
                          "endPosition": {
                            "row": 28,
                            "column": 20
                          },
                          "children": []
                        },
                        {
                          "type": "generic_name",
                          "text": "Task<IActionResult>",
                          "startPosition": {
                            "row": 28,
                            "column": 21
                          },
                          "endPosition": {
                            "row": 28,
                            "column": 40
                          },
                          "children": [
                            {
                              "type": "identifier",
                              "text": "Task",
                              "startPosition": {
                                "row": 28,
                                "column": 21
                              },
                              "endPosition": {
                                "row": 28,
                                "column": 25
                              },
                              "children": []
                            },
                            {
                              "type": "type_argument_list",
                              "text": "<IActionResult>",
                              "startPosition": {
                                "row": 28,
                                "column": 25
                              },
                              "endPosition": {
                                "row": 28,
                                "column": 40
                              },
                              "children": [
                                {
                                  "type": "identifier",
                                  "text": "IActionResult",
                                  "startPosition": {
                                    "row": 28,
                                    "column": 26
                                  },
                                  "endPosition": {
                                    "row": 28,
                                    "column": 39
                                  },
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "identifier",
                          "text": "Login",
                          "startPosition": {
                            "row": 28,
                            "column": 41
                          },
                          "endPosition": {
                            "row": 28,
                            "column": 46
                          },
                          "children": []
                        },
                        {
                          "type": "parameter_list",
                          "text": "([FromBody] LoginRequest loginRequest)",
                          "startPosition": {
                            "row": 28,
                            "column": 46
                          },
                          "endPosition": {
                            "row": 28,
                            "column": 84
                          },
                          "children": [
                            {
                              "type": "parameter",
                              "text": "[FromBody] LoginRequest loginRequest",
                              "startPosition": {
                                "row": 28,
                                "column": 47
                              },
                              "endPosition": {
                                "row": 28,
                                "column": 83
                              },
                              "children": [
                                {
                                  "type": "attribute_list",
                                  "text": "[FromBody]",
                                  "startPosition": {
                                    "row": 28,
                                    "column": 47
                                  },
                                  "endPosition": {
                                    "row": 28,
                                    "column": 57
                                  },
                                  "children": [
                                    {
                                      "type": "attribute",
                                      "text": "FromBody",
                                      "startPosition": {
                                        "row": 28,
                                        "column": 48
                                      },
                                      "endPosition": {
                                        "row": 28,
                                        "column": 56
                                      },
                                      "children": [
                                        {
                                          "type": "identifier",
                                          "text": "FromBody",
                                          "startPosition": {
                                            "row": 28,
                                            "column": 48
                                          },
                                          "endPosition": {
                                            "row": 28,
                                            "column": 56
                                          },
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "identifier",
                                  "text": "LoginRequest",
                                  "startPosition": {
                                    "row": 28,
                                    "column": 58
                                  },
                                  "endPosition": {
                                    "row": 28,
                                    "column": 70
                                  },
                                  "children": []
                                },
                                {
                                  "type": "identifier",
                                  "text": "loginRequest",
                                  "startPosition": {
                                    "row": 28,
                                    "column": 71
                                  },
                                  "endPosition": {
                                    "row": 28,
                                    "column": 83
                                  },
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "block",
                          "text": "{\r\n            // Find the user by email\r\n            var user = await _context.Users.FirstOrDefaultAsync(u => u.Email == loginRequest.Email);\r\n            if (user == null)\r\n            {\r\n                // Return Unauthorized for login error\r\n                return Unauthorized(\"Invalid email or password.\");\r\n            }\r\n\r\n            if (!BCrypt.Net.BCrypt.Verify(loginRequest.Password, user.Password))\r\n            {\r\n                // Return Unauthorized for wrong password\r\n                return Unauthorized(\"Invalid email or password\");\r\n            }\r\n\r\n            var token = GenerateJwtToken(user);\r\n            return Ok(new { token });\r\n        }",
                          "startPosition": {
                            "row": 29,
                            "column": 8
                          },
                          "endPosition": {
                            "row": 46,
                            "column": 9
                          },
                          "children": [
                            {
                              "type": "comment",
                              "text": "// Find the user by email",
                              "startPosition": {
                                "row": 30,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 30,
                                "column": 37
                              },
                              "children": []
                            },
                            {
                              "type": "local_declaration_statement",
                              "text": "var user = await _context.Users.FirstOrDefaultAsync(u => u.Email == loginRequest.Email);",
                              "startPosition": {
                                "row": 31,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 31,
                                "column": 100
                              },
                              "children": [
                                {
                                  "type": "variable_declaration",
                                  "text": "var user = await _context.Users.FirstOrDefaultAsync(u => u.Email == loginRequest.Email)",
                                  "startPosition": {
                                    "row": 31,
                                    "column": 12
                                  },
                                  "endPosition": {
                                    "row": 31,
                                    "column": 99
                                  },
                                  "children": [
                                    {
                                      "type": "implicit_type",
                                      "text": "var",
                                      "startPosition": {
                                        "row": 31,
                                        "column": 12
                                      },
                                      "endPosition": {
                                        "row": 31,
                                        "column": 15
                                      },
                                      "children": []
                                    },
                                    {
                                      "type": "variable_declarator",
                                      "text": "user = await _context.Users.FirstOrDefaultAsync(u => u.Email == loginRequest.Email)",
                                      "startPosition": {
                                        "row": 31,
                                        "column": 16
                                      },
                                      "endPosition": {
                                        "row": 31,
                                        "column": 99
                                      },
                                      "children": [
                                        {
                                          "type": "identifier",
                                          "text": "user",
                                          "startPosition": {
                                            "row": 31,
                                            "column": 16
                                          },
                                          "endPosition": {
                                            "row": 31,
                                            "column": 20
                                          },
                                          "children": []
                                        },
                                        {
                                          "type": "equals_value_clause",
                                          "text": "= await _context.Users.FirstOrDefaultAsync(u => u.Email == loginRequest.Email)",
                                          "startPosition": {
                                            "row": 31,
                                            "column": 21
                                          },
                                          "endPosition": {
                                            "row": 31,
                                            "column": 99
                                          },
                                          "children": [
                                            {
                                              "type": "await_expression",
                                              "text": "await _context.Users.FirstOrDefaultAsync(u => u.Email == loginRequest.Email)",
                                              "startPosition": {
                                                "row": 31,
                                                "column": 23
                                              },
                                              "endPosition": {
                                                "row": 31,
                                                "column": 99
                                              },
                                              "children": [
                                                {
                                                  "type": "invocation_expression",
                                                  "text": "_context.Users.FirstOrDefaultAsync(u => u.Email == loginRequest.Email)",
                                                  "startPosition": {
                                                    "row": 31,
                                                    "column": 29
                                                  },
                                                  "endPosition": {
                                                    "row": 31,
                                                    "column": 99
                                                  },
                                                  "children": [
                                                    {
                                                      "type": "member_access_expression",
                                                      "text": "_context.Users.FirstOrDefaultAsync",
                                                      "startPosition": {
                                                        "row": 31,
                                                        "column": 29
                                                      },
                                                      "endPosition": {
                                                        "row": 31,
                                                        "column": 63
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "member_access_expression",
                                                          "text": "_context.Users",
                                                          "startPosition": {
                                                            "row": 31,
                                                            "column": 29
                                                          },
                                                          "endPosition": {
                                                            "row": 31,
                                                            "column": 43
                                                          },
                                                          "children": [
                                                            {
                                                              "type": "identifier",
                                                              "text": "_context",
                                                              "startPosition": {
                                                                "row": 31,
                                                                "column": 29
                                                              },
                                                              "endPosition": {
                                                                "row": 31,
                                                                "column": 37
                                                              },
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "identifier",
                                                              "text": "Users",
                                                              "startPosition": {
                                                                "row": 31,
                                                                "column": 38
                                                              },
                                                              "endPosition": {
                                                                "row": 31,
                                                                "column": 43
                                                              },
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "identifier",
                                                          "text": "FirstOrDefaultAsync",
                                                          "startPosition": {
                                                            "row": 31,
                                                            "column": 44
                                                          },
                                                          "endPosition": {
                                                            "row": 31,
                                                            "column": 63
                                                          },
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "argument_list",
                                                      "text": "(u => u.Email == loginRequest.Email)",
                                                      "startPosition": {
                                                        "row": 31,
                                                        "column": 63
                                                      },
                                                      "endPosition": {
                                                        "row": 31,
                                                        "column": 99
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "argument",
                                                          "text": "u => u.Email == loginRequest.Email",
                                                          "startPosition": {
                                                            "row": 31,
                                                            "column": 64
                                                          },
                                                          "endPosition": {
                                                            "row": 31,
                                                            "column": 98
                                                          },
                                                          "children": [
                                                            {
                                                              "type": "lambda_expression",
                                                              "text": "u => u.Email == loginRequest.Email",
                                                              "startPosition": {
                                                                "row": 31,
                                                                "column": 64
                                                              },
                                                              "endPosition": {
                                                                "row": 31,
                                                                "column": 98
                                                              },
                                                              "children": [
                                                                {
                                                                  "type": "implicit_parameter_list",
                                                                  "text": "u",
                                                                  "startPosition": {
                                                                    "row": 31,
                                                                    "column": 64
                                                                  },
                                                                  "endPosition": {
                                                                    "row": 31,
                                                                    "column": 65
                                                                  },
                                                                  "children": [
                                                                    {
                                                                      "type": "parameter",
                                                                      "text": "u",
                                                                      "startPosition": {
                                                                        "row": 31,
                                                                        "column": 64
                                                                      },
                                                                      "endPosition": {
                                                                        "row": 31,
                                                                        "column": 65
                                                                      },
                                                                      "children": [
                                                                        {
                                                                          "type": "identifier",
                                                                          "text": "u",
                                                                          "startPosition": {
                                                                            "row": 31,
                                                                            "column": 64
                                                                          },
                                                                          "endPosition": {
                                                                            "row": 31,
                                                                            "column": 65
                                                                          },
                                                                          "children": []
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "type": "binary_expression",
                                                                  "text": "u.Email == loginRequest.Email",
                                                                  "startPosition": {
                                                                    "row": 31,
                                                                    "column": 69
                                                                  },
                                                                  "endPosition": {
                                                                    "row": 31,
                                                                    "column": 98
                                                                  },
                                                                  "children": [
                                                                    {
                                                                      "type": "member_access_expression",
                                                                      "text": "u.Email",
                                                                      "startPosition": {
                                                                        "row": 31,
                                                                        "column": 69
                                                                      },
                                                                      "endPosition": {
                                                                        "row": 31,
                                                                        "column": 76
                                                                      },
                                                                      "children": [
                                                                        {
                                                                          "type": "identifier",
                                                                          "text": "u",
                                                                          "startPosition": {
                                                                            "row": 31,
                                                                            "column": 69
                                                                          },
                                                                          "endPosition": {
                                                                            "row": 31,
                                                                            "column": 70
                                                                          },
                                                                          "children": []
                                                                        },
                                                                        {
                                                                          "type": "identifier",
                                                                          "text": "Email",
                                                                          "startPosition": {
                                                                            "row": 31,
                                                                            "column": 71
                                                                          },
                                                                          "endPosition": {
                                                                            "row": 31,
                                                                            "column": 76
                                                                          },
                                                                          "children": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "type": "member_access_expression",
                                                                      "text": "loginRequest.Email",
                                                                      "startPosition": {
                                                                        "row": 31,
                                                                        "column": 80
                                                                      },
                                                                      "endPosition": {
                                                                        "row": 31,
                                                                        "column": 98
                                                                      },
                                                                      "children": [
                                                                        {
                                                                          "type": "identifier",
                                                                          "text": "loginRequest",
                                                                          "startPosition": {
                                                                            "row": 31,
                                                                            "column": 80
                                                                          },
                                                                          "endPosition": {
                                                                            "row": 31,
                                                                            "column": 92
                                                                          },
                                                                          "children": []
                                                                        },
                                                                        {
                                                                          "type": "identifier",
                                                                          "text": "Email",
                                                                          "startPosition": {
                                                                            "row": 31,
                                                                            "column": 93
                                                                          },
                                                                          "endPosition": {
                                                                            "row": 31,
                                                                            "column": 98
                                                                          },
                                                                          "children": []
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "if_statement",
                              "text": "if (user == null)\r\n            {\r\n                // Return Unauthorized for login error\r\n                return Unauthorized(\"Invalid email or password.\");\r\n            }",
                              "startPosition": {
                                "row": 32,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 36,
                                "column": 13
                              },
                              "children": [
                                {
                                  "type": "binary_expression",
                                  "text": "user == null",
                                  "startPosition": {
                                    "row": 32,
                                    "column": 16
                                  },
                                  "endPosition": {
                                    "row": 32,
                                    "column": 28
                                  },
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "text": "user",
                                      "startPosition": {
                                        "row": 32,
                                        "column": 16
                                      },
                                      "endPosition": {
                                        "row": 32,
                                        "column": 20
                                      },
                                      "children": []
                                    },
                                    {
                                      "type": "null_literal",
                                      "text": "null",
                                      "startPosition": {
                                        "row": 32,
                                        "column": 24
                                      },
                                      "endPosition": {
                                        "row": 32,
                                        "column": 28
                                      },
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "block",
                                  "text": "{\r\n                // Return Unauthorized for login error\r\n                return Unauthorized(\"Invalid email or password.\");\r\n            }",
                                  "startPosition": {
                                    "row": 33,
                                    "column": 12
                                  },
                                  "endPosition": {
                                    "row": 36,
                                    "column": 13
                                  },
                                  "children": [
                                    {
                                      "type": "comment",
                                      "text": "// Return Unauthorized for login error",
                                      "startPosition": {
                                        "row": 34,
                                        "column": 16
                                      },
                                      "endPosition": {
                                        "row": 34,
                                        "column": 54
                                      },
                                      "children": []
                                    },
                                    {
                                      "type": "return_statement",
                                      "text": "return Unauthorized(\"Invalid email or password.\");",
                                      "startPosition": {
                                        "row": 35,
                                        "column": 16
                                      },
                                      "endPosition": {
                                        "row": 35,
                                        "column": 66
                                      },
                                      "children": [
                                        {
                                          "type": "invocation_expression",
                                          "text": "Unauthorized(\"Invalid email or password.\")",
                                          "startPosition": {
                                            "row": 35,
                                            "column": 23
                                          },
                                          "endPosition": {
                                            "row": 35,
                                            "column": 65
                                          },
                                          "children": [
                                            {
                                              "type": "identifier",
                                              "text": "Unauthorized",
                                              "startPosition": {
                                                "row": 35,
                                                "column": 23
                                              },
                                              "endPosition": {
                                                "row": 35,
                                                "column": 35
                                              },
                                              "children": []
                                            },
                                            {
                                              "type": "argument_list",
                                              "text": "(\"Invalid email or password.\")",
                                              "startPosition": {
                                                "row": 35,
                                                "column": 35
                                              },
                                              "endPosition": {
                                                "row": 35,
                                                "column": 65
                                              },
                                              "children": [
                                                {
                                                  "type": "argument",
                                                  "text": "\"Invalid email or password.\"",
                                                  "startPosition": {
                                                    "row": 35,
                                                    "column": 36
                                                  },
                                                  "endPosition": {
                                                    "row": 35,
                                                    "column": 64
                                                  },
                                                  "children": [
                                                    {
                                                      "type": "string_literal",
                                                      "text": "\"Invalid email or password.\"",
                                                      "startPosition": {
                                                        "row": 35,
                                                        "column": 36
                                                      },
                                                      "endPosition": {
                                                        "row": 35,
                                                        "column": 64
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "string_literal_fragment",
                                                          "text": "Invalid email or password.",
                                                          "startPosition": {
                                                            "row": 35,
                                                            "column": 37
                                                          },
                                                          "endPosition": {
                                                            "row": 35,
                                                            "column": 63
                                                          },
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "if_statement",
                              "text": "if (!BCrypt.Net.BCrypt.Verify(loginRequest.Password, user.Password))\r\n            {\r\n                // Return Unauthorized for wrong password\r\n                return Unauthorized(\"Invalid email or password\");\r\n            }",
                              "startPosition": {
                                "row": 38,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 42,
                                "column": 13
                              },
                              "children": [
                                {
                                  "type": "prefix_unary_expression",
                                  "text": "!BCrypt.Net.BCrypt.Verify(loginRequest.Password, user.Password)",
                                  "startPosition": {
                                    "row": 38,
                                    "column": 16
                                  },
                                  "endPosition": {
                                    "row": 38,
                                    "column": 79
                                  },
                                  "children": [
                                    {
                                      "type": "invocation_expression",
                                      "text": "BCrypt.Net.BCrypt.Verify(loginRequest.Password, user.Password)",
                                      "startPosition": {
                                        "row": 38,
                                        "column": 17
                                      },
                                      "endPosition": {
                                        "row": 38,
                                        "column": 79
                                      },
                                      "children": [
                                        {
                                          "type": "member_access_expression",
                                          "text": "BCrypt.Net.BCrypt.Verify",
                                          "startPosition": {
                                            "row": 38,
                                            "column": 17
                                          },
                                          "endPosition": {
                                            "row": 38,
                                            "column": 41
                                          },
                                          "children": [
                                            {
                                              "type": "member_access_expression",
                                              "text": "BCrypt.Net.BCrypt",
                                              "startPosition": {
                                                "row": 38,
                                                "column": 17
                                              },
                                              "endPosition": {
                                                "row": 38,
                                                "column": 34
                                              },
                                              "children": [
                                                {
                                                  "type": "member_access_expression",
                                                  "text": "BCrypt.Net",
                                                  "startPosition": {
                                                    "row": 38,
                                                    "column": 17
                                                  },
                                                  "endPosition": {
                                                    "row": 38,
                                                    "column": 27
                                                  },
                                                  "children": [
                                                    {
                                                      "type": "identifier",
                                                      "text": "BCrypt",
                                                      "startPosition": {
                                                        "row": 38,
                                                        "column": 17
                                                      },
                                                      "endPosition": {
                                                        "row": 38,
                                                        "column": 23
                                                      },
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "identifier",
                                                      "text": "Net",
                                                      "startPosition": {
                                                        "row": 38,
                                                        "column": 24
                                                      },
                                                      "endPosition": {
                                                        "row": 38,
                                                        "column": 27
                                                      },
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "identifier",
                                                  "text": "BCrypt",
                                                  "startPosition": {
                                                    "row": 38,
                                                    "column": 28
                                                  },
                                                  "endPosition": {
                                                    "row": 38,
                                                    "column": 34
                                                  },
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "identifier",
                                              "text": "Verify",
                                              "startPosition": {
                                                "row": 38,
                                                "column": 35
                                              },
                                              "endPosition": {
                                                "row": 38,
                                                "column": 41
                                              },
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "argument_list",
                                          "text": "(loginRequest.Password, user.Password)",
                                          "startPosition": {
                                            "row": 38,
                                            "column": 41
                                          },
                                          "endPosition": {
                                            "row": 38,
                                            "column": 79
                                          },
                                          "children": [
                                            {
                                              "type": "argument",
                                              "text": "loginRequest.Password",
                                              "startPosition": {
                                                "row": 38,
                                                "column": 42
                                              },
                                              "endPosition": {
                                                "row": 38,
                                                "column": 63
                                              },
                                              "children": [
                                                {
                                                  "type": "member_access_expression",
                                                  "text": "loginRequest.Password",
                                                  "startPosition": {
                                                    "row": 38,
                                                    "column": 42
                                                  },
                                                  "endPosition": {
                                                    "row": 38,
                                                    "column": 63
                                                  },
                                                  "children": [
                                                    {
                                                      "type": "identifier",
                                                      "text": "loginRequest",
                                                      "startPosition": {
                                                        "row": 38,
                                                        "column": 42
                                                      },
                                                      "endPosition": {
                                                        "row": 38,
                                                        "column": 54
                                                      },
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "identifier",
                                                      "text": "Password",
                                                      "startPosition": {
                                                        "row": 38,
                                                        "column": 55
                                                      },
                                                      "endPosition": {
                                                        "row": 38,
                                                        "column": 63
                                                      },
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "type": "argument",
                                              "text": "user.Password",
                                              "startPosition": {
                                                "row": 38,
                                                "column": 65
                                              },
                                              "endPosition": {
                                                "row": 38,
                                                "column": 78
                                              },
                                              "children": [
                                                {
                                                  "type": "member_access_expression",
                                                  "text": "user.Password",
                                                  "startPosition": {
                                                    "row": 38,
                                                    "column": 65
                                                  },
                                                  "endPosition": {
                                                    "row": 38,
                                                    "column": 78
                                                  },
                                                  "children": [
                                                    {
                                                      "type": "identifier",
                                                      "text": "user",
                                                      "startPosition": {
                                                        "row": 38,
                                                        "column": 65
                                                      },
                                                      "endPosition": {
                                                        "row": 38,
                                                        "column": 69
                                                      },
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "identifier",
                                                      "text": "Password",
                                                      "startPosition": {
                                                        "row": 38,
                                                        "column": 70
                                                      },
                                                      "endPosition": {
                                                        "row": 38,
                                                        "column": 78
                                                      },
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "block",
                                  "text": "{\r\n                // Return Unauthorized for wrong password\r\n                return Unauthorized(\"Invalid email or password\");\r\n            }",
                                  "startPosition": {
                                    "row": 39,
                                    "column": 12
                                  },
                                  "endPosition": {
                                    "row": 42,
                                    "column": 13
                                  },
                                  "children": [
                                    {
                                      "type": "comment",
                                      "text": "// Return Unauthorized for wrong password",
                                      "startPosition": {
                                        "row": 40,
                                        "column": 16
                                      },
                                      "endPosition": {
                                        "row": 40,
                                        "column": 57
                                      },
                                      "children": []
                                    },
                                    {
                                      "type": "return_statement",
                                      "text": "return Unauthorized(\"Invalid email or password\");",
                                      "startPosition": {
                                        "row": 41,
                                        "column": 16
                                      },
                                      "endPosition": {
                                        "row": 41,
                                        "column": 65
                                      },
                                      "children": [
                                        {
                                          "type": "invocation_expression",
                                          "text": "Unauthorized(\"Invalid email or password\")",
                                          "startPosition": {
                                            "row": 41,
                                            "column": 23
                                          },
                                          "endPosition": {
                                            "row": 41,
                                            "column": 64
                                          },
                                          "children": [
                                            {
                                              "type": "identifier",
                                              "text": "Unauthorized",
                                              "startPosition": {
                                                "row": 41,
                                                "column": 23
                                              },
                                              "endPosition": {
                                                "row": 41,
                                                "column": 35
                                              },
                                              "children": []
                                            },
                                            {
                                              "type": "argument_list",
                                              "text": "(\"Invalid email or password\")",
                                              "startPosition": {
                                                "row": 41,
                                                "column": 35
                                              },
                                              "endPosition": {
                                                "row": 41,
                                                "column": 64
                                              },
                                              "children": [
                                                {
                                                  "type": "argument",
                                                  "text": "\"Invalid email or password\"",
                                                  "startPosition": {
                                                    "row": 41,
                                                    "column": 36
                                                  },
                                                  "endPosition": {
                                                    "row": 41,
                                                    "column": 63
                                                  },
                                                  "children": [
                                                    {
                                                      "type": "string_literal",
                                                      "text": "\"Invalid email or password\"",
                                                      "startPosition": {
                                                        "row": 41,
                                                        "column": 36
                                                      },
                                                      "endPosition": {
                                                        "row": 41,
                                                        "column": 63
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "string_literal_fragment",
                                                          "text": "Invalid email or password",
                                                          "startPosition": {
                                                            "row": 41,
                                                            "column": 37
                                                          },
                                                          "endPosition": {
                                                            "row": 41,
                                                            "column": 62
                                                          },
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "local_declaration_statement",
                              "text": "var token = GenerateJwtToken(user);",
                              "startPosition": {
                                "row": 44,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 44,
                                "column": 47
                              },
                              "children": [
                                {
                                  "type": "variable_declaration",
                                  "text": "var token = GenerateJwtToken(user)",
                                  "startPosition": {
                                    "row": 44,
                                    "column": 12
                                  },
                                  "endPosition": {
                                    "row": 44,
                                    "column": 46
                                  },
                                  "children": [
                                    {
                                      "type": "implicit_type",
                                      "text": "var",
                                      "startPosition": {
                                        "row": 44,
                                        "column": 12
                                      },
                                      "endPosition": {
                                        "row": 44,
                                        "column": 15
                                      },
                                      "children": []
                                    },
                                    {
                                      "type": "variable_declarator",
                                      "text": "token = GenerateJwtToken(user)",
                                      "startPosition": {
                                        "row": 44,
                                        "column": 16
                                      },
                                      "endPosition": {
                                        "row": 44,
                                        "column": 46
                                      },
                                      "children": [
                                        {
                                          "type": "identifier",
                                          "text": "token",
                                          "startPosition": {
                                            "row": 44,
                                            "column": 16
                                          },
                                          "endPosition": {
                                            "row": 44,
                                            "column": 21
                                          },
                                          "children": []
                                        },
                                        {
                                          "type": "equals_value_clause",
                                          "text": "= GenerateJwtToken(user)",
                                          "startPosition": {
                                            "row": 44,
                                            "column": 22
                                          },
                                          "endPosition": {
                                            "row": 44,
                                            "column": 46
                                          },
                                          "children": [
                                            {
                                              "type": "invocation_expression",
                                              "text": "GenerateJwtToken(user)",
                                              "startPosition": {
                                                "row": 44,
                                                "column": 24
                                              },
                                              "endPosition": {
                                                "row": 44,
                                                "column": 46
                                              },
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "text": "GenerateJwtToken",
                                                  "startPosition": {
                                                    "row": 44,
                                                    "column": 24
                                                  },
                                                  "endPosition": {
                                                    "row": 44,
                                                    "column": 40
                                                  },
                                                  "children": []
                                                },
                                                {
                                                  "type": "argument_list",
                                                  "text": "(user)",
                                                  "startPosition": {
                                                    "row": 44,
                                                    "column": 40
                                                  },
                                                  "endPosition": {
                                                    "row": 44,
                                                    "column": 46
                                                  },
                                                  "children": [
                                                    {
                                                      "type": "argument",
                                                      "text": "user",
                                                      "startPosition": {
                                                        "row": 44,
                                                        "column": 41
                                                      },
                                                      "endPosition": {
                                                        "row": 44,
                                                        "column": 45
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "identifier",
                                                          "text": "user",
                                                          "startPosition": {
                                                            "row": 44,
                                                            "column": 41
                                                          },
                                                          "endPosition": {
                                                            "row": 44,
                                                            "column": 45
                                                          },
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "return_statement",
                              "text": "return Ok(new { token });",
                              "startPosition": {
                                "row": 45,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 45,
                                "column": 37
                              },
                              "children": [
                                {
                                  "type": "invocation_expression",
                                  "text": "Ok(new { token })",
                                  "startPosition": {
                                    "row": 45,
                                    "column": 19
                                  },
                                  "endPosition": {
                                    "row": 45,
                                    "column": 36
                                  },
                                  "children": [
                                    {
                                      "type": "identifier",
                                      "text": "Ok",
                                      "startPosition": {
                                        "row": 45,
                                        "column": 19
                                      },
                                      "endPosition": {
                                        "row": 45,
                                        "column": 21
                                      },
                                      "children": []
                                    },
                                    {
                                      "type": "argument_list",
                                      "text": "(new { token })",
                                      "startPosition": {
                                        "row": 45,
                                        "column": 21
                                      },
                                      "endPosition": {
                                        "row": 45,
                                        "column": 36
                                      },
                                      "children": [
                                        {
                                          "type": "argument",
                                          "text": "new { token }",
                                          "startPosition": {
                                            "row": 45,
                                            "column": 22
                                          },
                                          "endPosition": {
                                            "row": 45,
                                            "column": 35
                                          },
                                          "children": [
                                            {
                                              "type": "anonymous_object_creation_expression",
                                              "text": "new { token }",
                                              "startPosition": {
                                                "row": 45,
                                                "column": 22
                                              },
                                              "endPosition": {
                                                "row": 45,
                                                "column": 35
                                              },
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "text": "token",
                                                  "startPosition": {
                                                    "row": 45,
                                                    "column": 28
                                                  },
                                                  "endPosition": {
                                                    "row": 45,
                                                    "column": 33
                                                  },
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "comment",
                      "text": "// Generate JWT Token",
                      "startPosition": {
                        "row": 48,
                        "column": 8
                      },
                      "endPosition": {
                        "row": 48,
                        "column": 29
                      },
                      "children": []
                    },
                    {
                      "type": "method_declaration",
                      "text": "public string GenerateJwtToken(User user)\r\n        {\r\n            // Configuring JWT Authentication\r\n            var jwtKey = _configuration[\"Jwt:Key\"]; // JWT Key\r\n            var jwtIssuer = _configuration[\"Jwt:Issuer\"]; // JWT Issuer\r\n            var jwtAudience = _configuration[\"Jwt:Audience\"]; // JWT Audience\r\n\r\n            // Check if the JWT config values are missing\r\n            if (string.IsNullOrEmpty(jwtKey) || string.IsNullOrEmpty(jwtIssuer) || string.IsNullOrEmpty(jwtAudience))\r\n            {\r\n                throw new InvalidOperationException(\"JWT configuration values are missing\");\r\n            }\r\n\r\n            var securityKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtKey));\r\n            var credentials = new SigningCredentials(securityKey, SecurityAlgorithms.HmacSha256); // SHA 256\r\n\r\n            var claims = new[]\r\n            {\r\n                new Claim(JwtRegisteredClaimNames.Sub, user.Email),\r\n                new Claim(JwtRegisteredClaimNames.Jti, Guid.NewGuid().ToString())\r\n            };\r\n\r\n            var token = new JwtSecurityToken(\r\n                issuer: jwtIssuer,\r\n                audience: jwtAudience,\r\n                claims: claims,\r\n                expires: DateTime.Now.AddMinutes(30), // 30 mins expiry\r\n                signingCredentials: credentials);\r\n            \r\n            return new JwtSecurityTokenHandler().WriteToken(token);\r\n        }",
                      "startPosition": {
                        "row": 49,
                        "column": 8
                      },
                      "endPosition": {
                        "row": 79,
                        "column": 9
                      },
                      "children": [
                        {
                          "type": "modifier",
                          "text": "public",
                          "startPosition": {
                            "row": 49,
                            "column": 8
                          },
                          "endPosition": {
                            "row": 49,
                            "column": 14
                          },
                          "children": []
                        },
                        {
                          "type": "predefined_type",
                          "text": "string",
                          "startPosition": {
                            "row": 49,
                            "column": 15
                          },
                          "endPosition": {
                            "row": 49,
                            "column": 21
                          },
                          "children": []
                        },
                        {
                          "type": "identifier",
                          "text": "GenerateJwtToken",
                          "startPosition": {
                            "row": 49,
                            "column": 22
                          },
                          "endPosition": {
                            "row": 49,
                            "column": 38
                          },
                          "children": []
                        },
                        {
                          "type": "parameter_list",
                          "text": "(User user)",
                          "startPosition": {
                            "row": 49,
                            "column": 38
                          },
                          "endPosition": {
                            "row": 49,
                            "column": 49
                          },
                          "children": [
                            {
                              "type": "parameter",
                              "text": "User user",
                              "startPosition": {
                                "row": 49,
                                "column": 39
                              },
                              "endPosition": {
                                "row": 49,
                                "column": 48
                              },
                              "children": [
                                {
                                  "type": "identifier",
                                  "text": "User",
                                  "startPosition": {
                                    "row": 49,
                                    "column": 39
                                  },
                                  "endPosition": {
                                    "row": 49,
                                    "column": 43
                                  },
                                  "children": []
                                },
                                {
                                  "type": "identifier",
                                  "text": "user",
                                  "startPosition": {
                                    "row": 49,
                                    "column": 44
                                  },
                                  "endPosition": {
                                    "row": 49,
                                    "column": 48
                                  },
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "block",
                          "text": "{\r\n            // Configuring JWT Authentication\r\n            var jwtKey = _configuration[\"Jwt:Key\"]; // JWT Key\r\n            var jwtIssuer = _configuration[\"Jwt:Issuer\"]; // JWT Issuer\r\n            var jwtAudience = _configuration[\"Jwt:Audience\"]; // JWT Audience\r\n\r\n            // Check if the JWT config values are missing\r\n            if (string.IsNullOrEmpty(jwtKey) || string.IsNullOrEmpty(jwtIssuer) || string.IsNullOrEmpty(jwtAudience))\r\n            {\r\n                throw new InvalidOperationException(\"JWT configuration values are missing\");\r\n            }\r\n\r\n            var securityKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtKey));\r\n            var credentials = new SigningCredentials(securityKey, SecurityAlgorithms.HmacSha256); // SHA 256\r\n\r\n            var claims = new[]\r\n            {\r\n                new Claim(JwtRegisteredClaimNames.Sub, user.Email),\r\n                new Claim(JwtRegisteredClaimNames.Jti, Guid.NewGuid().ToString())\r\n            };\r\n\r\n            var token = new JwtSecurityToken(\r\n                issuer: jwtIssuer,\r\n                audience: jwtAudience,\r\n                claims: claims,\r\n                expires: DateTime.Now.AddMinutes(30), // 30 mins expiry\r\n                signingCredentials: credentials);\r\n            \r\n            return new JwtSecurityTokenHandler().WriteToken(token);\r\n        }",
                          "startPosition": {
                            "row": 50,
                            "column": 8
                          },
                          "endPosition": {
                            "row": 79,
                            "column": 9
                          },
                          "children": [
                            {
                              "type": "comment",
                              "text": "// Configuring JWT Authentication",
                              "startPosition": {
                                "row": 51,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 51,
                                "column": 45
                              },
                              "children": []
                            },
                            {
                              "type": "local_declaration_statement",
                              "text": "var jwtKey = _configuration[\"Jwt:Key\"];",
                              "startPosition": {
                                "row": 52,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 52,
                                "column": 51
                              },
                              "children": [
                                {
                                  "type": "variable_declaration",
                                  "text": "var jwtKey = _configuration[\"Jwt:Key\"]",
                                  "startPosition": {
                                    "row": 52,
                                    "column": 12
                                  },
                                  "endPosition": {
                                    "row": 52,
                                    "column": 50
                                  },
                                  "children": [
                                    {
                                      "type": "implicit_type",
                                      "text": "var",
                                      "startPosition": {
                                        "row": 52,
                                        "column": 12
                                      },
                                      "endPosition": {
                                        "row": 52,
                                        "column": 15
                                      },
                                      "children": []
                                    },
                                    {
                                      "type": "variable_declarator",
                                      "text": "jwtKey = _configuration[\"Jwt:Key\"]",
                                      "startPosition": {
                                        "row": 52,
                                        "column": 16
                                      },
                                      "endPosition": {
                                        "row": 52,
                                        "column": 50
                                      },
                                      "children": [
                                        {
                                          "type": "identifier",
                                          "text": "jwtKey",
                                          "startPosition": {
                                            "row": 52,
                                            "column": 16
                                          },
                                          "endPosition": {
                                            "row": 52,
                                            "column": 22
                                          },
                                          "children": []
                                        },
                                        {
                                          "type": "equals_value_clause",
                                          "text": "= _configuration[\"Jwt:Key\"]",
                                          "startPosition": {
                                            "row": 52,
                                            "column": 23
                                          },
                                          "endPosition": {
                                            "row": 52,
                                            "column": 50
                                          },
                                          "children": [
                                            {
                                              "type": "element_access_expression",
                                              "text": "_configuration[\"Jwt:Key\"]",
                                              "startPosition": {
                                                "row": 52,
                                                "column": 25
                                              },
                                              "endPosition": {
                                                "row": 52,
                                                "column": 50
                                              },
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "text": "_configuration",
                                                  "startPosition": {
                                                    "row": 52,
                                                    "column": 25
                                                  },
                                                  "endPosition": {
                                                    "row": 52,
                                                    "column": 39
                                                  },
                                                  "children": []
                                                },
                                                {
                                                  "type": "bracketed_argument_list",
                                                  "text": "[\"Jwt:Key\"]",
                                                  "startPosition": {
                                                    "row": 52,
                                                    "column": 39
                                                  },
                                                  "endPosition": {
                                                    "row": 52,
                                                    "column": 50
                                                  },
                                                  "children": [
                                                    {
                                                      "type": "argument",
                                                      "text": "\"Jwt:Key\"",
                                                      "startPosition": {
                                                        "row": 52,
                                                        "column": 40
                                                      },
                                                      "endPosition": {
                                                        "row": 52,
                                                        "column": 49
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "string_literal",
                                                          "text": "\"Jwt:Key\"",
                                                          "startPosition": {
                                                            "row": 52,
                                                            "column": 40
                                                          },
                                                          "endPosition": {
                                                            "row": 52,
                                                            "column": 49
                                                          },
                                                          "children": [
                                                            {
                                                              "type": "string_literal_fragment",
                                                              "text": "Jwt:Key",
                                                              "startPosition": {
                                                                "row": 52,
                                                                "column": 41
                                                              },
                                                              "endPosition": {
                                                                "row": 52,
                                                                "column": 48
                                                              },
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "comment",
                              "text": "// JWT Key",
                              "startPosition": {
                                "row": 52,
                                "column": 52
                              },
                              "endPosition": {
                                "row": 52,
                                "column": 62
                              },
                              "children": []
                            },
                            {
                              "type": "local_declaration_statement",
                              "text": "var jwtIssuer = _configuration[\"Jwt:Issuer\"];",
                              "startPosition": {
                                "row": 53,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 53,
                                "column": 57
                              },
                              "children": [
                                {
                                  "type": "variable_declaration",
                                  "text": "var jwtIssuer = _configuration[\"Jwt:Issuer\"]",
                                  "startPosition": {
                                    "row": 53,
                                    "column": 12
                                  },
                                  "endPosition": {
                                    "row": 53,
                                    "column": 56
                                  },
                                  "children": [
                                    {
                                      "type": "implicit_type",
                                      "text": "var",
                                      "startPosition": {
                                        "row": 53,
                                        "column": 12
                                      },
                                      "endPosition": {
                                        "row": 53,
                                        "column": 15
                                      },
                                      "children": []
                                    },
                                    {
                                      "type": "variable_declarator",
                                      "text": "jwtIssuer = _configuration[\"Jwt:Issuer\"]",
                                      "startPosition": {
                                        "row": 53,
                                        "column": 16
                                      },
                                      "endPosition": {
                                        "row": 53,
                                        "column": 56
                                      },
                                      "children": [
                                        {
                                          "type": "identifier",
                                          "text": "jwtIssuer",
                                          "startPosition": {
                                            "row": 53,
                                            "column": 16
                                          },
                                          "endPosition": {
                                            "row": 53,
                                            "column": 25
                                          },
                                          "children": []
                                        },
                                        {
                                          "type": "equals_value_clause",
                                          "text": "= _configuration[\"Jwt:Issuer\"]",
                                          "startPosition": {
                                            "row": 53,
                                            "column": 26
                                          },
                                          "endPosition": {
                                            "row": 53,
                                            "column": 56
                                          },
                                          "children": [
                                            {
                                              "type": "element_access_expression",
                                              "text": "_configuration[\"Jwt:Issuer\"]",
                                              "startPosition": {
                                                "row": 53,
                                                "column": 28
                                              },
                                              "endPosition": {
                                                "row": 53,
                                                "column": 56
                                              },
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "text": "_configuration",
                                                  "startPosition": {
                                                    "row": 53,
                                                    "column": 28
                                                  },
                                                  "endPosition": {
                                                    "row": 53,
                                                    "column": 42
                                                  },
                                                  "children": []
                                                },
                                                {
                                                  "type": "bracketed_argument_list",
                                                  "text": "[\"Jwt:Issuer\"]",
                                                  "startPosition": {
                                                    "row": 53,
                                                    "column": 42
                                                  },
                                                  "endPosition": {
                                                    "row": 53,
                                                    "column": 56
                                                  },
                                                  "children": [
                                                    {
                                                      "type": "argument",
                                                      "text": "\"Jwt:Issuer\"",
                                                      "startPosition": {
                                                        "row": 53,
                                                        "column": 43
                                                      },
                                                      "endPosition": {
                                                        "row": 53,
                                                        "column": 55
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "string_literal",
                                                          "text": "\"Jwt:Issuer\"",
                                                          "startPosition": {
                                                            "row": 53,
                                                            "column": 43
                                                          },
                                                          "endPosition": {
                                                            "row": 53,
                                                            "column": 55
                                                          },
                                                          "children": [
                                                            {
                                                              "type": "string_literal_fragment",
                                                              "text": "Jwt:Issuer",
                                                              "startPosition": {
                                                                "row": 53,
                                                                "column": 44
                                                              },
                                                              "endPosition": {
                                                                "row": 53,
                                                                "column": 54
                                                              },
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "comment",
                              "text": "// JWT Issuer",
                              "startPosition": {
                                "row": 53,
                                "column": 58
                              },
                              "endPosition": {
                                "row": 53,
                                "column": 71
                              },
                              "children": []
                            },
                            {
                              "type": "local_declaration_statement",
                              "text": "var jwtAudience = _configuration[\"Jwt:Audience\"];",
                              "startPosition": {
                                "row": 54,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 54,
                                "column": 61
                              },
                              "children": [
                                {
                                  "type": "variable_declaration",
                                  "text": "var jwtAudience = _configuration[\"Jwt:Audience\"]",
                                  "startPosition": {
                                    "row": 54,
                                    "column": 12
                                  },
                                  "endPosition": {
                                    "row": 54,
                                    "column": 60
                                  },
                                  "children": [
                                    {
                                      "type": "implicit_type",
                                      "text": "var",
                                      "startPosition": {
                                        "row": 54,
                                        "column": 12
                                      },
                                      "endPosition": {
                                        "row": 54,
                                        "column": 15
                                      },
                                      "children": []
                                    },
                                    {
                                      "type": "variable_declarator",
                                      "text": "jwtAudience = _configuration[\"Jwt:Audience\"]",
                                      "startPosition": {
                                        "row": 54,
                                        "column": 16
                                      },
                                      "endPosition": {
                                        "row": 54,
                                        "column": 60
                                      },
                                      "children": [
                                        {
                                          "type": "identifier",
                                          "text": "jwtAudience",
                                          "startPosition": {
                                            "row": 54,
                                            "column": 16
                                          },
                                          "endPosition": {
                                            "row": 54,
                                            "column": 27
                                          },
                                          "children": []
                                        },
                                        {
                                          "type": "equals_value_clause",
                                          "text": "= _configuration[\"Jwt:Audience\"]",
                                          "startPosition": {
                                            "row": 54,
                                            "column": 28
                                          },
                                          "endPosition": {
                                            "row": 54,
                                            "column": 60
                                          },
                                          "children": [
                                            {
                                              "type": "element_access_expression",
                                              "text": "_configuration[\"Jwt:Audience\"]",
                                              "startPosition": {
                                                "row": 54,
                                                "column": 30
                                              },
                                              "endPosition": {
                                                "row": 54,
                                                "column": 60
                                              },
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "text": "_configuration",
                                                  "startPosition": {
                                                    "row": 54,
                                                    "column": 30
                                                  },
                                                  "endPosition": {
                                                    "row": 54,
                                                    "column": 44
                                                  },
                                                  "children": []
                                                },
                                                {
                                                  "type": "bracketed_argument_list",
                                                  "text": "[\"Jwt:Audience\"]",
                                                  "startPosition": {
                                                    "row": 54,
                                                    "column": 44
                                                  },
                                                  "endPosition": {
                                                    "row": 54,
                                                    "column": 60
                                                  },
                                                  "children": [
                                                    {
                                                      "type": "argument",
                                                      "text": "\"Jwt:Audience\"",
                                                      "startPosition": {
                                                        "row": 54,
                                                        "column": 45
                                                      },
                                                      "endPosition": {
                                                        "row": 54,
                                                        "column": 59
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "string_literal",
                                                          "text": "\"Jwt:Audience\"",
                                                          "startPosition": {
                                                            "row": 54,
                                                            "column": 45
                                                          },
                                                          "endPosition": {
                                                            "row": 54,
                                                            "column": 59
                                                          },
                                                          "children": [
                                                            {
                                                              "type": "string_literal_fragment",
                                                              "text": "Jwt:Audience",
                                                              "startPosition": {
                                                                "row": 54,
                                                                "column": 46
                                                              },
                                                              "endPosition": {
                                                                "row": 54,
                                                                "column": 58
                                                              },
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "comment",
                              "text": "// JWT Audience",
                              "startPosition": {
                                "row": 54,
                                "column": 62
                              },
                              "endPosition": {
                                "row": 54,
                                "column": 77
                              },
                              "children": []
                            },
                            {
                              "type": "comment",
                              "text": "// Check if the JWT config values are missing",
                              "startPosition": {
                                "row": 56,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 56,
                                "column": 57
                              },
                              "children": []
                            },
                            {
                              "type": "if_statement",
                              "text": "if (string.IsNullOrEmpty(jwtKey) || string.IsNullOrEmpty(jwtIssuer) || string.IsNullOrEmpty(jwtAudience))\r\n            {\r\n                throw new InvalidOperationException(\"JWT configuration values are missing\");\r\n            }",
                              "startPosition": {
                                "row": 57,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 60,
                                "column": 13
                              },
                              "children": [
                                {
                                  "type": "binary_expression",
                                  "text": "string.IsNullOrEmpty(jwtKey) || string.IsNullOrEmpty(jwtIssuer) || string.IsNullOrEmpty(jwtAudience)",
                                  "startPosition": {
                                    "row": 57,
                                    "column": 16
                                  },
                                  "endPosition": {
                                    "row": 57,
                                    "column": 116
                                  },
                                  "children": [
                                    {
                                      "type": "binary_expression",
                                      "text": "string.IsNullOrEmpty(jwtKey) || string.IsNullOrEmpty(jwtIssuer)",
                                      "startPosition": {
                                        "row": 57,
                                        "column": 16
                                      },
                                      "endPosition": {
                                        "row": 57,
                                        "column": 79
                                      },
                                      "children": [
                                        {
                                          "type": "invocation_expression",
                                          "text": "string.IsNullOrEmpty(jwtKey)",
                                          "startPosition": {
                                            "row": 57,
                                            "column": 16
                                          },
                                          "endPosition": {
                                            "row": 57,
                                            "column": 44
                                          },
                                          "children": [
                                            {
                                              "type": "member_access_expression",
                                              "text": "string.IsNullOrEmpty",
                                              "startPosition": {
                                                "row": 57,
                                                "column": 16
                                              },
                                              "endPosition": {
                                                "row": 57,
                                                "column": 36
                                              },
                                              "children": [
                                                {
                                                  "type": "predefined_type",
                                                  "text": "string",
                                                  "startPosition": {
                                                    "row": 57,
                                                    "column": 16
                                                  },
                                                  "endPosition": {
                                                    "row": 57,
                                                    "column": 22
                                                  },
                                                  "children": []
                                                },
                                                {
                                                  "type": "identifier",
                                                  "text": "IsNullOrEmpty",
                                                  "startPosition": {
                                                    "row": 57,
                                                    "column": 23
                                                  },
                                                  "endPosition": {
                                                    "row": 57,
                                                    "column": 36
                                                  },
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "argument_list",
                                              "text": "(jwtKey)",
                                              "startPosition": {
                                                "row": 57,
                                                "column": 36
                                              },
                                              "endPosition": {
                                                "row": 57,
                                                "column": 44
                                              },
                                              "children": [
                                                {
                                                  "type": "argument",
                                                  "text": "jwtKey",
                                                  "startPosition": {
                                                    "row": 57,
                                                    "column": 37
                                                  },
                                                  "endPosition": {
                                                    "row": 57,
                                                    "column": 43
                                                  },
                                                  "children": [
                                                    {
                                                      "type": "identifier",
                                                      "text": "jwtKey",
                                                      "startPosition": {
                                                        "row": 57,
                                                        "column": 37
                                                      },
                                                      "endPosition": {
                                                        "row": 57,
                                                        "column": 43
                                                      },
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "invocation_expression",
                                          "text": "string.IsNullOrEmpty(jwtIssuer)",
                                          "startPosition": {
                                            "row": 57,
                                            "column": 48
                                          },
                                          "endPosition": {
                                            "row": 57,
                                            "column": 79
                                          },
                                          "children": [
                                            {
                                              "type": "member_access_expression",
                                              "text": "string.IsNullOrEmpty",
                                              "startPosition": {
                                                "row": 57,
                                                "column": 48
                                              },
                                              "endPosition": {
                                                "row": 57,
                                                "column": 68
                                              },
                                              "children": [
                                                {
                                                  "type": "predefined_type",
                                                  "text": "string",
                                                  "startPosition": {
                                                    "row": 57,
                                                    "column": 48
                                                  },
                                                  "endPosition": {
                                                    "row": 57,
                                                    "column": 54
                                                  },
                                                  "children": []
                                                },
                                                {
                                                  "type": "identifier",
                                                  "text": "IsNullOrEmpty",
                                                  "startPosition": {
                                                    "row": 57,
                                                    "column": 55
                                                  },
                                                  "endPosition": {
                                                    "row": 57,
                                                    "column": 68
                                                  },
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "argument_list",
                                              "text": "(jwtIssuer)",
                                              "startPosition": {
                                                "row": 57,
                                                "column": 68
                                              },
                                              "endPosition": {
                                                "row": 57,
                                                "column": 79
                                              },
                                              "children": [
                                                {
                                                  "type": "argument",
                                                  "text": "jwtIssuer",
                                                  "startPosition": {
                                                    "row": 57,
                                                    "column": 69
                                                  },
                                                  "endPosition": {
                                                    "row": 57,
                                                    "column": 78
                                                  },
                                                  "children": [
                                                    {
                                                      "type": "identifier",
                                                      "text": "jwtIssuer",
                                                      "startPosition": {
                                                        "row": 57,
                                                        "column": 69
                                                      },
                                                      "endPosition": {
                                                        "row": 57,
                                                        "column": 78
                                                      },
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "type": "invocation_expression",
                                      "text": "string.IsNullOrEmpty(jwtAudience)",
                                      "startPosition": {
                                        "row": 57,
                                        "column": 83
                                      },
                                      "endPosition": {
                                        "row": 57,
                                        "column": 116
                                      },
                                      "children": [
                                        {
                                          "type": "member_access_expression",
                                          "text": "string.IsNullOrEmpty",
                                          "startPosition": {
                                            "row": 57,
                                            "column": 83
                                          },
                                          "endPosition": {
                                            "row": 57,
                                            "column": 103
                                          },
                                          "children": [
                                            {
                                              "type": "predefined_type",
                                              "text": "string",
                                              "startPosition": {
                                                "row": 57,
                                                "column": 83
                                              },
                                              "endPosition": {
                                                "row": 57,
                                                "column": 89
                                              },
                                              "children": []
                                            },
                                            {
                                              "type": "identifier",
                                              "text": "IsNullOrEmpty",
                                              "startPosition": {
                                                "row": 57,
                                                "column": 90
                                              },
                                              "endPosition": {
                                                "row": 57,
                                                "column": 103
                                              },
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "argument_list",
                                          "text": "(jwtAudience)",
                                          "startPosition": {
                                            "row": 57,
                                            "column": 103
                                          },
                                          "endPosition": {
                                            "row": 57,
                                            "column": 116
                                          },
                                          "children": [
                                            {
                                              "type": "argument",
                                              "text": "jwtAudience",
                                              "startPosition": {
                                                "row": 57,
                                                "column": 104
                                              },
                                              "endPosition": {
                                                "row": 57,
                                                "column": 115
                                              },
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "text": "jwtAudience",
                                                  "startPosition": {
                                                    "row": 57,
                                                    "column": 104
                                                  },
                                                  "endPosition": {
                                                    "row": 57,
                                                    "column": 115
                                                  },
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "block",
                                  "text": "{\r\n                throw new InvalidOperationException(\"JWT configuration values are missing\");\r\n            }",
                                  "startPosition": {
                                    "row": 58,
                                    "column": 12
                                  },
                                  "endPosition": {
                                    "row": 60,
                                    "column": 13
                                  },
                                  "children": [
                                    {
                                      "type": "throw_statement",
                                      "text": "throw new InvalidOperationException(\"JWT configuration values are missing\");",
                                      "startPosition": {
                                        "row": 59,
                                        "column": 16
                                      },
                                      "endPosition": {
                                        "row": 59,
                                        "column": 92
                                      },
                                      "children": [
                                        {
                                          "type": "object_creation_expression",
                                          "text": "new InvalidOperationException(\"JWT configuration values are missing\")",
                                          "startPosition": {
                                            "row": 59,
                                            "column": 22
                                          },
                                          "endPosition": {
                                            "row": 59,
                                            "column": 91
                                          },
                                          "children": [
                                            {
                                              "type": "identifier",
                                              "text": "InvalidOperationException",
                                              "startPosition": {
                                                "row": 59,
                                                "column": 26
                                              },
                                              "endPosition": {
                                                "row": 59,
                                                "column": 51
                                              },
                                              "children": []
                                            },
                                            {
                                              "type": "argument_list",
                                              "text": "(\"JWT configuration values are missing\")",
                                              "startPosition": {
                                                "row": 59,
                                                "column": 51
                                              },
                                              "endPosition": {
                                                "row": 59,
                                                "column": 91
                                              },
                                              "children": [
                                                {
                                                  "type": "argument",
                                                  "text": "\"JWT configuration values are missing\"",
                                                  "startPosition": {
                                                    "row": 59,
                                                    "column": 52
                                                  },
                                                  "endPosition": {
                                                    "row": 59,
                                                    "column": 90
                                                  },
                                                  "children": [
                                                    {
                                                      "type": "string_literal",
                                                      "text": "\"JWT configuration values are missing\"",
                                                      "startPosition": {
                                                        "row": 59,
                                                        "column": 52
                                                      },
                                                      "endPosition": {
                                                        "row": 59,
                                                        "column": 90
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "string_literal_fragment",
                                                          "text": "JWT configuration values are missing",
                                                          "startPosition": {
                                                            "row": 59,
                                                            "column": 53
                                                          },
                                                          "endPosition": {
                                                            "row": 59,
                                                            "column": 89
                                                          },
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "local_declaration_statement",
                              "text": "var securityKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtKey));",
                              "startPosition": {
                                "row": 62,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 62,
                                "column": 87
                              },
                              "children": [
                                {
                                  "type": "variable_declaration",
                                  "text": "var securityKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtKey))",
                                  "startPosition": {
                                    "row": 62,
                                    "column": 12
                                  },
                                  "endPosition": {
                                    "row": 62,
                                    "column": 86
                                  },
                                  "children": [
                                    {
                                      "type": "implicit_type",
                                      "text": "var",
                                      "startPosition": {
                                        "row": 62,
                                        "column": 12
                                      },
                                      "endPosition": {
                                        "row": 62,
                                        "column": 15
                                      },
                                      "children": []
                                    },
                                    {
                                      "type": "variable_declarator",
                                      "text": "securityKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtKey))",
                                      "startPosition": {
                                        "row": 62,
                                        "column": 16
                                      },
                                      "endPosition": {
                                        "row": 62,
                                        "column": 86
                                      },
                                      "children": [
                                        {
                                          "type": "identifier",
                                          "text": "securityKey",
                                          "startPosition": {
                                            "row": 62,
                                            "column": 16
                                          },
                                          "endPosition": {
                                            "row": 62,
                                            "column": 27
                                          },
                                          "children": []
                                        },
                                        {
                                          "type": "equals_value_clause",
                                          "text": "= new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtKey))",
                                          "startPosition": {
                                            "row": 62,
                                            "column": 28
                                          },
                                          "endPosition": {
                                            "row": 62,
                                            "column": 86
                                          },
                                          "children": [
                                            {
                                              "type": "object_creation_expression",
                                              "text": "new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtKey))",
                                              "startPosition": {
                                                "row": 62,
                                                "column": 30
                                              },
                                              "endPosition": {
                                                "row": 62,
                                                "column": 86
                                              },
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "text": "SymmetricSecurityKey",
                                                  "startPosition": {
                                                    "row": 62,
                                                    "column": 34
                                                  },
                                                  "endPosition": {
                                                    "row": 62,
                                                    "column": 54
                                                  },
                                                  "children": []
                                                },
                                                {
                                                  "type": "argument_list",
                                                  "text": "(Encoding.UTF8.GetBytes(jwtKey))",
                                                  "startPosition": {
                                                    "row": 62,
                                                    "column": 54
                                                  },
                                                  "endPosition": {
                                                    "row": 62,
                                                    "column": 86
                                                  },
                                                  "children": [
                                                    {
                                                      "type": "argument",
                                                      "text": "Encoding.UTF8.GetBytes(jwtKey)",
                                                      "startPosition": {
                                                        "row": 62,
                                                        "column": 55
                                                      },
                                                      "endPosition": {
                                                        "row": 62,
                                                        "column": 85
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "invocation_expression",
                                                          "text": "Encoding.UTF8.GetBytes(jwtKey)",
                                                          "startPosition": {
                                                            "row": 62,
                                                            "column": 55
                                                          },
                                                          "endPosition": {
                                                            "row": 62,
                                                            "column": 85
                                                          },
                                                          "children": [
                                                            {
                                                              "type": "member_access_expression",
                                                              "text": "Encoding.UTF8.GetBytes",
                                                              "startPosition": {
                                                                "row": 62,
                                                                "column": 55
                                                              },
                                                              "endPosition": {
                                                                "row": 62,
                                                                "column": 77
                                                              },
                                                              "children": [
                                                                {
                                                                  "type": "member_access_expression",
                                                                  "text": "Encoding.UTF8",
                                                                  "startPosition": {
                                                                    "row": 62,
                                                                    "column": 55
                                                                  },
                                                                  "endPosition": {
                                                                    "row": 62,
                                                                    "column": 68
                                                                  },
                                                                  "children": [
                                                                    {
                                                                      "type": "identifier",
                                                                      "text": "Encoding",
                                                                      "startPosition": {
                                                                        "row": 62,
                                                                        "column": 55
                                                                      },
                                                                      "endPosition": {
                                                                        "row": 62,
                                                                        "column": 63
                                                                      },
                                                                      "children": []
                                                                    },
                                                                    {
                                                                      "type": "identifier",
                                                                      "text": "UTF8",
                                                                      "startPosition": {
                                                                        "row": 62,
                                                                        "column": 64
                                                                      },
                                                                      "endPosition": {
                                                                        "row": 62,
                                                                        "column": 68
                                                                      },
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "type": "identifier",
                                                                  "text": "GetBytes",
                                                                  "startPosition": {
                                                                    "row": 62,
                                                                    "column": 69
                                                                  },
                                                                  "endPosition": {
                                                                    "row": 62,
                                                                    "column": 77
                                                                  },
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "argument_list",
                                                              "text": "(jwtKey)",
                                                              "startPosition": {
                                                                "row": 62,
                                                                "column": 77
                                                              },
                                                              "endPosition": {
                                                                "row": 62,
                                                                "column": 85
                                                              },
                                                              "children": [
                                                                {
                                                                  "type": "argument",
                                                                  "text": "jwtKey",
                                                                  "startPosition": {
                                                                    "row": 62,
                                                                    "column": 78
                                                                  },
                                                                  "endPosition": {
                                                                    "row": 62,
                                                                    "column": 84
                                                                  },
                                                                  "children": [
                                                                    {
                                                                      "type": "identifier",
                                                                      "text": "jwtKey",
                                                                      "startPosition": {
                                                                        "row": 62,
                                                                        "column": 78
                                                                      },
                                                                      "endPosition": {
                                                                        "row": 62,
                                                                        "column": 84
                                                                      },
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "local_declaration_statement",
                              "text": "var credentials = new SigningCredentials(securityKey, SecurityAlgorithms.HmacSha256);",
                              "startPosition": {
                                "row": 63,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 63,
                                "column": 97
                              },
                              "children": [
                                {
                                  "type": "variable_declaration",
                                  "text": "var credentials = new SigningCredentials(securityKey, SecurityAlgorithms.HmacSha256)",
                                  "startPosition": {
                                    "row": 63,
                                    "column": 12
                                  },
                                  "endPosition": {
                                    "row": 63,
                                    "column": 96
                                  },
                                  "children": [
                                    {
                                      "type": "implicit_type",
                                      "text": "var",
                                      "startPosition": {
                                        "row": 63,
                                        "column": 12
                                      },
                                      "endPosition": {
                                        "row": 63,
                                        "column": 15
                                      },
                                      "children": []
                                    },
                                    {
                                      "type": "variable_declarator",
                                      "text": "credentials = new SigningCredentials(securityKey, SecurityAlgorithms.HmacSha256)",
                                      "startPosition": {
                                        "row": 63,
                                        "column": 16
                                      },
                                      "endPosition": {
                                        "row": 63,
                                        "column": 96
                                      },
                                      "children": [
                                        {
                                          "type": "identifier",
                                          "text": "credentials",
                                          "startPosition": {
                                            "row": 63,
                                            "column": 16
                                          },
                                          "endPosition": {
                                            "row": 63,
                                            "column": 27
                                          },
                                          "children": []
                                        },
                                        {
                                          "type": "equals_value_clause",
                                          "text": "= new SigningCredentials(securityKey, SecurityAlgorithms.HmacSha256)",
                                          "startPosition": {
                                            "row": 63,
                                            "column": 28
                                          },
                                          "endPosition": {
                                            "row": 63,
                                            "column": 96
                                          },
                                          "children": [
                                            {
                                              "type": "object_creation_expression",
                                              "text": "new SigningCredentials(securityKey, SecurityAlgorithms.HmacSha256)",
                                              "startPosition": {
                                                "row": 63,
                                                "column": 30
                                              },
                                              "endPosition": {
                                                "row": 63,
                                                "column": 96
                                              },
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "text": "SigningCredentials",
                                                  "startPosition": {
                                                    "row": 63,
                                                    "column": 34
                                                  },
                                                  "endPosition": {
                                                    "row": 63,
                                                    "column": 52
                                                  },
                                                  "children": []
                                                },
                                                {
                                                  "type": "argument_list",
                                                  "text": "(securityKey, SecurityAlgorithms.HmacSha256)",
                                                  "startPosition": {
                                                    "row": 63,
                                                    "column": 52
                                                  },
                                                  "endPosition": {
                                                    "row": 63,
                                                    "column": 96
                                                  },
                                                  "children": [
                                                    {
                                                      "type": "argument",
                                                      "text": "securityKey",
                                                      "startPosition": {
                                                        "row": 63,
                                                        "column": 53
                                                      },
                                                      "endPosition": {
                                                        "row": 63,
                                                        "column": 64
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "identifier",
                                                          "text": "securityKey",
                                                          "startPosition": {
                                                            "row": 63,
                                                            "column": 53
                                                          },
                                                          "endPosition": {
                                                            "row": 63,
                                                            "column": 64
                                                          },
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "argument",
                                                      "text": "SecurityAlgorithms.HmacSha256",
                                                      "startPosition": {
                                                        "row": 63,
                                                        "column": 66
                                                      },
                                                      "endPosition": {
                                                        "row": 63,
                                                        "column": 95
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "member_access_expression",
                                                          "text": "SecurityAlgorithms.HmacSha256",
                                                          "startPosition": {
                                                            "row": 63,
                                                            "column": 66
                                                          },
                                                          "endPosition": {
                                                            "row": 63,
                                                            "column": 95
                                                          },
                                                          "children": [
                                                            {
                                                              "type": "identifier",
                                                              "text": "SecurityAlgorithms",
                                                              "startPosition": {
                                                                "row": 63,
                                                                "column": 66
                                                              },
                                                              "endPosition": {
                                                                "row": 63,
                                                                "column": 84
                                                              },
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "identifier",
                                                              "text": "HmacSha256",
                                                              "startPosition": {
                                                                "row": 63,
                                                                "column": 85
                                                              },
                                                              "endPosition": {
                                                                "row": 63,
                                                                "column": 95
                                                              },
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "comment",
                              "text": "// SHA 256",
                              "startPosition": {
                                "row": 63,
                                "column": 98
                              },
                              "endPosition": {
                                "row": 63,
                                "column": 108
                              },
                              "children": []
                            },
                            {
                              "type": "local_declaration_statement",
                              "text": "var claims = new[]\r\n            {\r\n                new Claim(JwtRegisteredClaimNames.Sub, user.Email),\r\n                new Claim(JwtRegisteredClaimNames.Jti, Guid.NewGuid().ToString())\r\n            };",
                              "startPosition": {
                                "row": 65,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 69,
                                "column": 14
                              },
                              "children": [
                                {
                                  "type": "variable_declaration",
                                  "text": "var claims = new[]\r\n            {\r\n                new Claim(JwtRegisteredClaimNames.Sub, user.Email),\r\n                new Claim(JwtRegisteredClaimNames.Jti, Guid.NewGuid().ToString())\r\n            }",
                                  "startPosition": {
                                    "row": 65,
                                    "column": 12
                                  },
                                  "endPosition": {
                                    "row": 69,
                                    "column": 13
                                  },
                                  "children": [
                                    {
                                      "type": "implicit_type",
                                      "text": "var",
                                      "startPosition": {
                                        "row": 65,
                                        "column": 12
                                      },
                                      "endPosition": {
                                        "row": 65,
                                        "column": 15
                                      },
                                      "children": []
                                    },
                                    {
                                      "type": "variable_declarator",
                                      "text": "claims = new[]\r\n            {\r\n                new Claim(JwtRegisteredClaimNames.Sub, user.Email),\r\n                new Claim(JwtRegisteredClaimNames.Jti, Guid.NewGuid().ToString())\r\n            }",
                                      "startPosition": {
                                        "row": 65,
                                        "column": 16
                                      },
                                      "endPosition": {
                                        "row": 69,
                                        "column": 13
                                      },
                                      "children": [
                                        {
                                          "type": "identifier",
                                          "text": "claims",
                                          "startPosition": {
                                            "row": 65,
                                            "column": 16
                                          },
                                          "endPosition": {
                                            "row": 65,
                                            "column": 22
                                          },
                                          "children": []
                                        },
                                        {
                                          "type": "equals_value_clause",
                                          "text": "= new[]\r\n            {\r\n                new Claim(JwtRegisteredClaimNames.Sub, user.Email),\r\n                new Claim(JwtRegisteredClaimNames.Jti, Guid.NewGuid().ToString())\r\n            }",
                                          "startPosition": {
                                            "row": 65,
                                            "column": 23
                                          },
                                          "endPosition": {
                                            "row": 69,
                                            "column": 13
                                          },
                                          "children": [
                                            {
                                              "type": "implicit_array_creation_expression",
                                              "text": "new[]\r\n            {\r\n                new Claim(JwtRegisteredClaimNames.Sub, user.Email),\r\n                new Claim(JwtRegisteredClaimNames.Jti, Guid.NewGuid().ToString())\r\n            }",
                                              "startPosition": {
                                                "row": 65,
                                                "column": 25
                                              },
                                              "endPosition": {
                                                "row": 69,
                                                "column": 13
                                              },
                                              "children": [
                                                {
                                                  "type": "initializer_expression",
                                                  "text": "{\r\n                new Claim(JwtRegisteredClaimNames.Sub, user.Email),\r\n                new Claim(JwtRegisteredClaimNames.Jti, Guid.NewGuid().ToString())\r\n            }",
                                                  "startPosition": {
                                                    "row": 66,
                                                    "column": 12
                                                  },
                                                  "endPosition": {
                                                    "row": 69,
                                                    "column": 13
                                                  },
                                                  "children": [
                                                    {
                                                      "type": "object_creation_expression",
                                                      "text": "new Claim(JwtRegisteredClaimNames.Sub, user.Email)",
                                                      "startPosition": {
                                                        "row": 67,
                                                        "column": 16
                                                      },
                                                      "endPosition": {
                                                        "row": 67,
                                                        "column": 66
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "identifier",
                                                          "text": "Claim",
                                                          "startPosition": {
                                                            "row": 67,
                                                            "column": 20
                                                          },
                                                          "endPosition": {
                                                            "row": 67,
                                                            "column": 25
                                                          },
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "argument_list",
                                                          "text": "(JwtRegisteredClaimNames.Sub, user.Email)",
                                                          "startPosition": {
                                                            "row": 67,
                                                            "column": 25
                                                          },
                                                          "endPosition": {
                                                            "row": 67,
                                                            "column": 66
                                                          },
                                                          "children": [
                                                            {
                                                              "type": "argument",
                                                              "text": "JwtRegisteredClaimNames.Sub",
                                                              "startPosition": {
                                                                "row": 67,
                                                                "column": 26
                                                              },
                                                              "endPosition": {
                                                                "row": 67,
                                                                "column": 53
                                                              },
                                                              "children": [
                                                                {
                                                                  "type": "member_access_expression",
                                                                  "text": "JwtRegisteredClaimNames.Sub",
                                                                  "startPosition": {
                                                                    "row": 67,
                                                                    "column": 26
                                                                  },
                                                                  "endPosition": {
                                                                    "row": 67,
                                                                    "column": 53
                                                                  },
                                                                  "children": [
                                                                    {
                                                                      "type": "identifier",
                                                                      "text": "JwtRegisteredClaimNames",
                                                                      "startPosition": {
                                                                        "row": 67,
                                                                        "column": 26
                                                                      },
                                                                      "endPosition": {
                                                                        "row": 67,
                                                                        "column": 49
                                                                      },
                                                                      "children": []
                                                                    },
                                                                    {
                                                                      "type": "identifier",
                                                                      "text": "Sub",
                                                                      "startPosition": {
                                                                        "row": 67,
                                                                        "column": 50
                                                                      },
                                                                      "endPosition": {
                                                                        "row": 67,
                                                                        "column": 53
                                                                      },
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "argument",
                                                              "text": "user.Email",
                                                              "startPosition": {
                                                                "row": 67,
                                                                "column": 55
                                                              },
                                                              "endPosition": {
                                                                "row": 67,
                                                                "column": 65
                                                              },
                                                              "children": [
                                                                {
                                                                  "type": "member_access_expression",
                                                                  "text": "user.Email",
                                                                  "startPosition": {
                                                                    "row": 67,
                                                                    "column": 55
                                                                  },
                                                                  "endPosition": {
                                                                    "row": 67,
                                                                    "column": 65
                                                                  },
                                                                  "children": [
                                                                    {
                                                                      "type": "identifier",
                                                                      "text": "user",
                                                                      "startPosition": {
                                                                        "row": 67,
                                                                        "column": 55
                                                                      },
                                                                      "endPosition": {
                                                                        "row": 67,
                                                                        "column": 59
                                                                      },
                                                                      "children": []
                                                                    },
                                                                    {
                                                                      "type": "identifier",
                                                                      "text": "Email",
                                                                      "startPosition": {
                                                                        "row": 67,
                                                                        "column": 60
                                                                      },
                                                                      "endPosition": {
                                                                        "row": 67,
                                                                        "column": 65
                                                                      },
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "object_creation_expression",
                                                      "text": "new Claim(JwtRegisteredClaimNames.Jti, Guid.NewGuid().ToString())",
                                                      "startPosition": {
                                                        "row": 68,
                                                        "column": 16
                                                      },
                                                      "endPosition": {
                                                        "row": 68,
                                                        "column": 81
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "identifier",
                                                          "text": "Claim",
                                                          "startPosition": {
                                                            "row": 68,
                                                            "column": 20
                                                          },
                                                          "endPosition": {
                                                            "row": 68,
                                                            "column": 25
                                                          },
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "argument_list",
                                                          "text": "(JwtRegisteredClaimNames.Jti, Guid.NewGuid().ToString())",
                                                          "startPosition": {
                                                            "row": 68,
                                                            "column": 25
                                                          },
                                                          "endPosition": {
                                                            "row": 68,
                                                            "column": 81
                                                          },
                                                          "children": [
                                                            {
                                                              "type": "argument",
                                                              "text": "JwtRegisteredClaimNames.Jti",
                                                              "startPosition": {
                                                                "row": 68,
                                                                "column": 26
                                                              },
                                                              "endPosition": {
                                                                "row": 68,
                                                                "column": 53
                                                              },
                                                              "children": [
                                                                {
                                                                  "type": "member_access_expression",
                                                                  "text": "JwtRegisteredClaimNames.Jti",
                                                                  "startPosition": {
                                                                    "row": 68,
                                                                    "column": 26
                                                                  },
                                                                  "endPosition": {
                                                                    "row": 68,
                                                                    "column": 53
                                                                  },
                                                                  "children": [
                                                                    {
                                                                      "type": "identifier",
                                                                      "text": "JwtRegisteredClaimNames",
                                                                      "startPosition": {
                                                                        "row": 68,
                                                                        "column": 26
                                                                      },
                                                                      "endPosition": {
                                                                        "row": 68,
                                                                        "column": 49
                                                                      },
                                                                      "children": []
                                                                    },
                                                                    {
                                                                      "type": "identifier",
                                                                      "text": "Jti",
                                                                      "startPosition": {
                                                                        "row": 68,
                                                                        "column": 50
                                                                      },
                                                                      "endPosition": {
                                                                        "row": 68,
                                                                        "column": 53
                                                                      },
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "argument",
                                                              "text": "Guid.NewGuid().ToString()",
                                                              "startPosition": {
                                                                "row": 68,
                                                                "column": 55
                                                              },
                                                              "endPosition": {
                                                                "row": 68,
                                                                "column": 80
                                                              },
                                                              "children": [
                                                                {
                                                                  "type": "invocation_expression",
                                                                  "text": "Guid.NewGuid().ToString()",
                                                                  "startPosition": {
                                                                    "row": 68,
                                                                    "column": 55
                                                                  },
                                                                  "endPosition": {
                                                                    "row": 68,
                                                                    "column": 80
                                                                  },
                                                                  "children": [
                                                                    {
                                                                      "type": "member_access_expression",
                                                                      "text": "Guid.NewGuid().ToString",
                                                                      "startPosition": {
                                                                        "row": 68,
                                                                        "column": 55
                                                                      },
                                                                      "endPosition": {
                                                                        "row": 68,
                                                                        "column": 78
                                                                      },
                                                                      "children": [
                                                                        {
                                                                          "type": "invocation_expression",
                                                                          "text": "Guid.NewGuid()",
                                                                          "startPosition": {
                                                                            "row": 68,
                                                                            "column": 55
                                                                          },
                                                                          "endPosition": {
                                                                            "row": 68,
                                                                            "column": 69
                                                                          },
                                                                          "children": [
                                                                            {
                                                                              "type": "member_access_expression",
                                                                              "text": "Guid.NewGuid",
                                                                              "startPosition": {
                                                                                "row": 68,
                                                                                "column": 55
                                                                              },
                                                                              "endPosition": {
                                                                                "row": 68,
                                                                                "column": 67
                                                                              },
                                                                              "children": [
                                                                                {
                                                                                  "type": "identifier",
                                                                                  "text": "Guid",
                                                                                  "startPosition": {
                                                                                    "row": 68,
                                                                                    "column": 55
                                                                                  },
                                                                                  "endPosition": {
                                                                                    "row": 68,
                                                                                    "column": 59
                                                                                  },
                                                                                  "children": []
                                                                                },
                                                                                {
                                                                                  "type": "identifier",
                                                                                  "text": "NewGuid",
                                                                                  "startPosition": {
                                                                                    "row": 68,
                                                                                    "column": 60
                                                                                  },
                                                                                  "endPosition": {
                                                                                    "row": 68,
                                                                                    "column": 67
                                                                                  },
                                                                                  "children": []
                                                                                }
                                                                              ]
                                                                            },
                                                                            {
                                                                              "type": "argument_list",
                                                                              "text": "()",
                                                                              "startPosition": {
                                                                                "row": 68,
                                                                                "column": 67
                                                                              },
                                                                              "endPosition": {
                                                                                "row": 68,
                                                                                "column": 69
                                                                              },
                                                                              "children": []
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "type": "identifier",
                                                                          "text": "ToString",
                                                                          "startPosition": {
                                                                            "row": 68,
                                                                            "column": 70
                                                                          },
                                                                          "endPosition": {
                                                                            "row": 68,
                                                                            "column": 78
                                                                          },
                                                                          "children": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "type": "argument_list",
                                                                      "text": "()",
                                                                      "startPosition": {
                                                                        "row": 68,
                                                                        "column": 78
                                                                      },
                                                                      "endPosition": {
                                                                        "row": 68,
                                                                        "column": 80
                                                                      },
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "local_declaration_statement",
                              "text": "var token = new JwtSecurityToken(\r\n                issuer: jwtIssuer,\r\n                audience: jwtAudience,\r\n                claims: claims,\r\n                expires: DateTime.Now.AddMinutes(30), // 30 mins expiry\r\n                signingCredentials: credentials);",
                              "startPosition": {
                                "row": 71,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 76,
                                "column": 49
                              },
                              "children": [
                                {
                                  "type": "variable_declaration",
                                  "text": "var token = new JwtSecurityToken(\r\n                issuer: jwtIssuer,\r\n                audience: jwtAudience,\r\n                claims: claims,\r\n                expires: DateTime.Now.AddMinutes(30), // 30 mins expiry\r\n                signingCredentials: credentials)",
                                  "startPosition": {
                                    "row": 71,
                                    "column": 12
                                  },
                                  "endPosition": {
                                    "row": 76,
                                    "column": 48
                                  },
                                  "children": [
                                    {
                                      "type": "implicit_type",
                                      "text": "var",
                                      "startPosition": {
                                        "row": 71,
                                        "column": 12
                                      },
                                      "endPosition": {
                                        "row": 71,
                                        "column": 15
                                      },
                                      "children": []
                                    },
                                    {
                                      "type": "variable_declarator",
                                      "text": "token = new JwtSecurityToken(\r\n                issuer: jwtIssuer,\r\n                audience: jwtAudience,\r\n                claims: claims,\r\n                expires: DateTime.Now.AddMinutes(30), // 30 mins expiry\r\n                signingCredentials: credentials)",
                                      "startPosition": {
                                        "row": 71,
                                        "column": 16
                                      },
                                      "endPosition": {
                                        "row": 76,
                                        "column": 48
                                      },
                                      "children": [
                                        {
                                          "type": "identifier",
                                          "text": "token",
                                          "startPosition": {
                                            "row": 71,
                                            "column": 16
                                          },
                                          "endPosition": {
                                            "row": 71,
                                            "column": 21
                                          },
                                          "children": []
                                        },
                                        {
                                          "type": "equals_value_clause",
                                          "text": "= new JwtSecurityToken(\r\n                issuer: jwtIssuer,\r\n                audience: jwtAudience,\r\n                claims: claims,\r\n                expires: DateTime.Now.AddMinutes(30), // 30 mins expiry\r\n                signingCredentials: credentials)",
                                          "startPosition": {
                                            "row": 71,
                                            "column": 22
                                          },
                                          "endPosition": {
                                            "row": 76,
                                            "column": 48
                                          },
                                          "children": [
                                            {
                                              "type": "object_creation_expression",
                                              "text": "new JwtSecurityToken(\r\n                issuer: jwtIssuer,\r\n                audience: jwtAudience,\r\n                claims: claims,\r\n                expires: DateTime.Now.AddMinutes(30), // 30 mins expiry\r\n                signingCredentials: credentials)",
                                              "startPosition": {
                                                "row": 71,
                                                "column": 24
                                              },
                                              "endPosition": {
                                                "row": 76,
                                                "column": 48
                                              },
                                              "children": [
                                                {
                                                  "type": "identifier",
                                                  "text": "JwtSecurityToken",
                                                  "startPosition": {
                                                    "row": 71,
                                                    "column": 28
                                                  },
                                                  "endPosition": {
                                                    "row": 71,
                                                    "column": 44
                                                  },
                                                  "children": []
                                                },
                                                {
                                                  "type": "argument_list",
                                                  "text": "(\r\n                issuer: jwtIssuer,\r\n                audience: jwtAudience,\r\n                claims: claims,\r\n                expires: DateTime.Now.AddMinutes(30), // 30 mins expiry\r\n                signingCredentials: credentials)",
                                                  "startPosition": {
                                                    "row": 71,
                                                    "column": 44
                                                  },
                                                  "endPosition": {
                                                    "row": 76,
                                                    "column": 48
                                                  },
                                                  "children": [
                                                    {
                                                      "type": "argument",
                                                      "text": "issuer: jwtIssuer",
                                                      "startPosition": {
                                                        "row": 72,
                                                        "column": 16
                                                      },
                                                      "endPosition": {
                                                        "row": 72,
                                                        "column": 33
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "name_colon",
                                                          "text": "issuer:",
                                                          "startPosition": {
                                                            "row": 72,
                                                            "column": 16
                                                          },
                                                          "endPosition": {
                                                            "row": 72,
                                                            "column": 23
                                                          },
                                                          "children": [
                                                            {
                                                              "type": "identifier",
                                                              "text": "issuer",
                                                              "startPosition": {
                                                                "row": 72,
                                                                "column": 16
                                                              },
                                                              "endPosition": {
                                                                "row": 72,
                                                                "column": 22
                                                              },
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "identifier",
                                                          "text": "jwtIssuer",
                                                          "startPosition": {
                                                            "row": 72,
                                                            "column": 24
                                                          },
                                                          "endPosition": {
                                                            "row": 72,
                                                            "column": 33
                                                          },
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "argument",
                                                      "text": "audience: jwtAudience",
                                                      "startPosition": {
                                                        "row": 73,
                                                        "column": 16
                                                      },
                                                      "endPosition": {
                                                        "row": 73,
                                                        "column": 37
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "name_colon",
                                                          "text": "audience:",
                                                          "startPosition": {
                                                            "row": 73,
                                                            "column": 16
                                                          },
                                                          "endPosition": {
                                                            "row": 73,
                                                            "column": 25
                                                          },
                                                          "children": [
                                                            {
                                                              "type": "identifier",
                                                              "text": "audience",
                                                              "startPosition": {
                                                                "row": 73,
                                                                "column": 16
                                                              },
                                                              "endPosition": {
                                                                "row": 73,
                                                                "column": 24
                                                              },
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "identifier",
                                                          "text": "jwtAudience",
                                                          "startPosition": {
                                                            "row": 73,
                                                            "column": 26
                                                          },
                                                          "endPosition": {
                                                            "row": 73,
                                                            "column": 37
                                                          },
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "argument",
                                                      "text": "claims: claims",
                                                      "startPosition": {
                                                        "row": 74,
                                                        "column": 16
                                                      },
                                                      "endPosition": {
                                                        "row": 74,
                                                        "column": 30
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "name_colon",
                                                          "text": "claims:",
                                                          "startPosition": {
                                                            "row": 74,
                                                            "column": 16
                                                          },
                                                          "endPosition": {
                                                            "row": 74,
                                                            "column": 23
                                                          },
                                                          "children": [
                                                            {
                                                              "type": "identifier",
                                                              "text": "claims",
                                                              "startPosition": {
                                                                "row": 74,
                                                                "column": 16
                                                              },
                                                              "endPosition": {
                                                                "row": 74,
                                                                "column": 22
                                                              },
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "identifier",
                                                          "text": "claims",
                                                          "startPosition": {
                                                            "row": 74,
                                                            "column": 24
                                                          },
                                                          "endPosition": {
                                                            "row": 74,
                                                            "column": 30
                                                          },
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "argument",
                                                      "text": "expires: DateTime.Now.AddMinutes(30)",
                                                      "startPosition": {
                                                        "row": 75,
                                                        "column": 16
                                                      },
                                                      "endPosition": {
                                                        "row": 75,
                                                        "column": 52
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "name_colon",
                                                          "text": "expires:",
                                                          "startPosition": {
                                                            "row": 75,
                                                            "column": 16
                                                          },
                                                          "endPosition": {
                                                            "row": 75,
                                                            "column": 24
                                                          },
                                                          "children": [
                                                            {
                                                              "type": "identifier",
                                                              "text": "expires",
                                                              "startPosition": {
                                                                "row": 75,
                                                                "column": 16
                                                              },
                                                              "endPosition": {
                                                                "row": 75,
                                                                "column": 23
                                                              },
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "invocation_expression",
                                                          "text": "DateTime.Now.AddMinutes(30)",
                                                          "startPosition": {
                                                            "row": 75,
                                                            "column": 25
                                                          },
                                                          "endPosition": {
                                                            "row": 75,
                                                            "column": 52
                                                          },
                                                          "children": [
                                                            {
                                                              "type": "member_access_expression",
                                                              "text": "DateTime.Now.AddMinutes",
                                                              "startPosition": {
                                                                "row": 75,
                                                                "column": 25
                                                              },
                                                              "endPosition": {
                                                                "row": 75,
                                                                "column": 48
                                                              },
                                                              "children": [
                                                                {
                                                                  "type": "member_access_expression",
                                                                  "text": "DateTime.Now",
                                                                  "startPosition": {
                                                                    "row": 75,
                                                                    "column": 25
                                                                  },
                                                                  "endPosition": {
                                                                    "row": 75,
                                                                    "column": 37
                                                                  },
                                                                  "children": [
                                                                    {
                                                                      "type": "identifier",
                                                                      "text": "DateTime",
                                                                      "startPosition": {
                                                                        "row": 75,
                                                                        "column": 25
                                                                      },
                                                                      "endPosition": {
                                                                        "row": 75,
                                                                        "column": 33
                                                                      },
                                                                      "children": []
                                                                    },
                                                                    {
                                                                      "type": "identifier",
                                                                      "text": "Now",
                                                                      "startPosition": {
                                                                        "row": 75,
                                                                        "column": 34
                                                                      },
                                                                      "endPosition": {
                                                                        "row": 75,
                                                                        "column": 37
                                                                      },
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "type": "identifier",
                                                                  "text": "AddMinutes",
                                                                  "startPosition": {
                                                                    "row": 75,
                                                                    "column": 38
                                                                  },
                                                                  "endPosition": {
                                                                    "row": 75,
                                                                    "column": 48
                                                                  },
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "argument_list",
                                                              "text": "(30)",
                                                              "startPosition": {
                                                                "row": 75,
                                                                "column": 48
                                                              },
                                                              "endPosition": {
                                                                "row": 75,
                                                                "column": 52
                                                              },
                                                              "children": [
                                                                {
                                                                  "type": "argument",
                                                                  "text": "30",
                                                                  "startPosition": {
                                                                    "row": 75,
                                                                    "column": 49
                                                                  },
                                                                  "endPosition": {
                                                                    "row": 75,
                                                                    "column": 51
                                                                  },
                                                                  "children": [
                                                                    {
                                                                      "type": "integer_literal",
                                                                      "text": "30",
                                                                      "startPosition": {
                                                                        "row": 75,
                                                                        "column": 49
                                                                      },
                                                                      "endPosition": {
                                                                        "row": 75,
                                                                        "column": 51
                                                                      },
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "comment",
                                                      "text": "// 30 mins expiry",
                                                      "startPosition": {
                                                        "row": 75,
                                                        "column": 54
                                                      },
                                                      "endPosition": {
                                                        "row": 75,
                                                        "column": 71
                                                      },
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "argument",
                                                      "text": "signingCredentials: credentials",
                                                      "startPosition": {
                                                        "row": 76,
                                                        "column": 16
                                                      },
                                                      "endPosition": {
                                                        "row": 76,
                                                        "column": 47
                                                      },
                                                      "children": [
                                                        {
                                                          "type": "name_colon",
                                                          "text": "signingCredentials:",
                                                          "startPosition": {
                                                            "row": 76,
                                                            "column": 16
                                                          },
                                                          "endPosition": {
                                                            "row": 76,
                                                            "column": 35
                                                          },
                                                          "children": [
                                                            {
                                                              "type": "identifier",
                                                              "text": "signingCredentials",
                                                              "startPosition": {
                                                                "row": 76,
                                                                "column": 16
                                                              },
                                                              "endPosition": {
                                                                "row": 76,
                                                                "column": 34
                                                              },
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "identifier",
                                                          "text": "credentials",
                                                          "startPosition": {
                                                            "row": 76,
                                                            "column": 36
                                                          },
                                                          "endPosition": {
                                                            "row": 76,
                                                            "column": 47
                                                          },
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "return_statement",
                              "text": "return new JwtSecurityTokenHandler().WriteToken(token);",
                              "startPosition": {
                                "row": 78,
                                "column": 12
                              },
                              "endPosition": {
                                "row": 78,
                                "column": 67
                              },
                              "children": [
                                {
                                  "type": "invocation_expression",
                                  "text": "new JwtSecurityTokenHandler().WriteToken(token)",
                                  "startPosition": {
                                    "row": 78,
                                    "column": 19
                                  },
                                  "endPosition": {
                                    "row": 78,
                                    "column": 66
                                  },
                                  "children": [
                                    {
                                      "type": "member_access_expression",
                                      "text": "new JwtSecurityTokenHandler().WriteToken",
                                      "startPosition": {
                                        "row": 78,
                                        "column": 19
                                      },
                                      "endPosition": {
                                        "row": 78,
                                        "column": 59
                                      },
                                      "children": [
                                        {
                                          "type": "object_creation_expression",
                                          "text": "new JwtSecurityTokenHandler()",
                                          "startPosition": {
                                            "row": 78,
                                            "column": 19
                                          },
                                          "endPosition": {
                                            "row": 78,
                                            "column": 48
                                          },
                                          "children": [
                                            {
                                              "type": "identifier",
                                              "text": "JwtSecurityTokenHandler",
                                              "startPosition": {
                                                "row": 78,
                                                "column": 23
                                              },
                                              "endPosition": {
                                                "row": 78,
                                                "column": 46
                                              },
                                              "children": []
                                            },
                                            {
                                              "type": "argument_list",
                                              "text": "()",
                                              "startPosition": {
                                                "row": 78,
                                                "column": 46
                                              },
                                              "endPosition": {
                                                "row": 78,
                                                "column": 48
                                              },
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "identifier",
                                          "text": "WriteToken",
                                          "startPosition": {
                                            "row": 78,
                                            "column": 49
                                          },
                                          "endPosition": {
                                            "row": 78,
                                            "column": 59
                                          },
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "argument_list",
                                      "text": "(token)",
                                      "startPosition": {
                                        "row": 78,
                                        "column": 59
                                      },
                                      "endPosition": {
                                        "row": 78,
                                        "column": 66
                                      },
                                      "children": [
                                        {
                                          "type": "argument",
                                          "text": "token",
                                          "startPosition": {
                                            "row": 78,
                                            "column": 60
                                          },
                                          "endPosition": {
                                            "row": 78,
                                            "column": 65
                                          },
                                          "children": [
                                            {
                                              "type": "identifier",
                                              "text": "token",
                                              "startPosition": {
                                                "row": 78,
                                                "column": 60
                                              },
                                              "endPosition": {
                                                "row": 78,
                                                "column": 65
                                              },
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}